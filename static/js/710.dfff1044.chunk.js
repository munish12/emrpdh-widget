"use strict";(self.webpackChunkerp_product_hub=self.webpackChunkerp_product_hub||[]).push([[710],{65077:(e,l,t)=>{t.d(l,{Z:()=>r});t(72791);var i=t(16236),o=t(94294),n=t(16029),a=t(97892),d=t.n(a),s=t(80184);const r=e=>{const{setOpenView:l,setView:t,onChange:a,value:r,...u}=e;return(0,s.jsxs)(n.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,s.jsx)(i.q,{...e}),(0,s.jsx)(o.Z,{onClick:()=>{const e=d()();a(e)},variant:"outlined",size:"small",style:{margin:"8px",position:"absolute",bottom:"2.5px",left:"2.5px"},children:"Today"})]})}},54869:(e,l,t)=>{t.d(l,{Z:()=>d});t(72791);var i=t(76633),o=t(16029),n=t(20068),a=t(80184);const d=function(e){let{title:l}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(n.Z,{title:l,children:(0,a.jsxs)(o.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:0,left:0,width:"100%",zIndex:9},children:[(0,a.jsx)(i.Z,{sx:{fontSize:60,color:"#1976d2",animation:"spin 1.5s linear infinite",width:"25px",height:"25px",position:"absolute"}}),(0,a.jsx)("style",{children:"\n          @keyframes spin {\n            0% { transform: rotate(0deg); }\n            100% { transform: rotate(360deg); }\n          }\n        "})]})})})}},91358:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Ye});var i=t(72791),o=t(66934),n=t(16029),a=t(20890),d=t(61889),s=t(94294),r=t(2101),u=t(43896),v=t(5574),c=t(65661),p=t(39157),m=t(51691),h=t(97123),x=t(6429),f=t.n(x),y=t(93274),g=t(6394),b=t(57689),w=t(31220),j=t(95048),P=t(19410),O=t(80245),E=t(7586),C=t(53994),T=t(58406),S=t(64387),R=t(39281),k=t(35527),D=t(79836),I=t(56890),M=t(35855),Z=t(53382),A=t(80184);const N=e=>{var l;let t="grey";switch(null===e||void 0===e||null===(l=e.status)||void 0===l?void 0:l.toLowerCase()){case"success":t="limegreen";break;case"inprogress":t="orange";break;case"failed":t="red";break;default:t="grey"}return(0,A.jsx)(A.Fragment,{children:(0,A.jsx)("span",{title:(i=null===e||void 0===e?void 0:e.status,i&&i[0].toUpperCase()+i.slice(1)||""),style:{width:"10px",height:"10px",backgroundColor:t,borderRadius:"50%",display:"block",margin:"auto"}})});var i};var L=t(30663),F=t(27391),B=t(85523),$=t(94454),V=t(10765),_=t(61419),U=t(92506),q=t(8007);const H=(0,o.ZP)({spanRed:{color:"#FF3D57"}}),G=(0,i.forwardRef)(((e,l)=>{const{selectedRowData:t,selectedRowFormdata:o,responseData:n,masterData:a,selectedRowIndex:s}=(0,j.v9)((e=>{var l,t,i,o,n;return{selectedRowData:null===e||void 0===e||null===(l=e.mcoDetails)||void 0===l?void 0:l.selectedRowData,selectedRowFormdata:null===e||void 0===e||null===(t=e.mcoDetails)||void 0===t?void 0:t.selectedRowFormdata,responseData:null===e||void 0===e||null===(i=e.mcoDetails)||void 0===i?void 0:i.responseData,masterData:null===e||void 0===e||null===(o=e.mcoDetails)||void 0===o?void 0:o.masterData,selectedRowIndex:null===e||void 0===e||null===(n=e.mcoDetails)||void 0===n?void 0:n.selectedRowIndex}}),j.wU),[r,u]=(0,i.useState)({}),[v,c]=(0,i.useState)({}),p=H();(0,i.useEffect)((()=>{let e={},l={};Object.keys(o).length&&(null===o||void 0===o||o.forEach((i=>{const o=null===i||void 0===i?void 0:i.name;if(Object.keys(t).includes(null===i||void 0===i?void 0:i.name)||null!==t&&void 0!==t&&t.attributeGroupData&&Object.keys(null===t||void 0===t?void 0:t.attributeGroupData).includes(null===i||void 0===i?void 0:i.name))return!0;"Y"===(null===i||void 0===i?void 0:i.mandatory)&&(e[o]=q.Z_().required(o+" required!")),""!==(null===i||void 0===i?void 0:i.defaultValues)?l[o]=null===i||void 0===i?void 0:i.defaultValues:l[o]=""}))),c(e),u(l)}),[t,o]);const m=q.Ry().shape(v);return(0,A.jsx)(U.J9,{initialValues:r,onSubmit:l=>(null===e||void 0===e||e.saveMaterialDetails(l),!1),enableReinitialize:!0,validationSchema:m,validateOnChange:!1,validateOnBlur:!1,children:function(e){let{values:r,errors:u,touched:v,handleChange:c,handleBlur:m,handleSubmit:h,isSubmitting:x,setSubmitting:y,setFieldValue:g,validateForm:b,isValid:w,submitForm:j}=e;return(0,i.useEffect)((()=>{setTimeout((async()=>{var e,l;const i=[],n=Object.keys(o).length&&(null===o||void 0===o?void 0:o.map(((e,l)=>e.name)));var d,r,u,v;null!==a&&void 0!==a&&null!==(e=a.mcoaffectedItem)&&void 0!==e&&e.length&&null!==a&&void 0!==a&&null!==(l=a.mcoaffectedItem[s])&&void 0!==l&&l.materialType&&null!==s&&n&&Object.keys(null===a||void 0===a||null===(d=a.mcoaffectedItem[s])||void 0===d||null===(r=d.materialType)||void 0===r?void 0:r.attributeMap).forEach((e=>{var l,d;const r=e;if(null!==a&&void 0!==a&&null!==(l=a.mcoaffectedItem[s])&&void 0!==l&&null!==(d=l.materialType)&&void 0!==d&&d.attributeMap[e]&&!i.includes(r)&&n.includes(r)&&(i.push(r),Object.keys(o).length)){var u,v;if(((null===o||void 0===o?void 0:o.filter(((e,l)=>(null===e||void 0===e?void 0:e.name)===r&&(Object.keys(t).includes(null===e||void 0===e?void 0:e.name)||(null===t||void 0===t?void 0:t.attributeGroupData)&&Object.keys(null===t||void 0===t?void 0:t.attributeGroupData).includes(null===e||void 0===e?void 0:e.name)))))||[]).length)return!0;const l=null===a||void 0===a||null===(u=a.mcoaffectedItem[s])||void 0===u||null===(v=u.materialType)||void 0===v?void 0:v.attributeMap[e];if(Array.isArray(l))return!0;g(r,l)}}));t&&Object.keys(t).length&&((null===t||void 0===t||null===(u=t.materialType)||void 0===u?void 0:u.attributeMap)&&Object.keys(null===t||void 0===t||null===(v=t.materialType)||void 0===v?void 0:v.attributeMap).forEach((e=>{var l;const a=e;if(null!==t&&void 0!==t&&null!==(l=t.materialType)&&void 0!==l&&l.attributeMap[e]&&n.includes(a)&&(i.push(a),Object.keys(o).length)){var d;if(((null===o||void 0===o?void 0:o.filter(((e,l)=>(null===e||void 0===e?void 0:e.name)===a&&(Object.keys(t).includes(null===e||void 0===e?void 0:e.name)||(null===t||void 0===t?void 0:t.attributeGroupData)&&Object.keys(null===t||void 0===t?void 0:t.attributeGroupData).includes(null===e||void 0===e?void 0:e.name)))))||[]).length)return!0;const l=null===t||void 0===t||null===(d=t.materialType)||void 0===d?void 0:d.attributeMap[e];if(Array.isArray(l))return!0;g(a,l)}})))}),500)}),[g]),(0,i.useImperativeHandle)(l,(()=>({callsubmitForm:()=>(j(),w)}))),(0,A.jsx)("form",{onSubmit:h,children:(0,A.jsx)("div",{children:Object.keys(o).length?null===o||void 0===o?void 0:o.map(((e,l)=>{var i;const o=null===e||void 0===e?void 0:e.name;if("N"===(null===n||void 0===n?void 0:n.isMaster)&&["Copy From"].includes(o))return!0;if(Object.keys(t).includes(o)||null!==t&&void 0!==t&&t.attributeGroupData&&Object.keys(null===t||void 0===t?void 0:t.attributeGroupData).includes(o))return!0;let s;s=!!(a&&Object.keys(a).length&&null!==a&&void 0!==a&&a.plantName.includes("SAP"))&&(Object.keys(a).length&&"N"===(null===a||void 0===a?void 0:a.master)&&"Y"===(null===e||void 0===e?void 0:e.material_master));const v=r[o]||(null===e||void 0===e?void 0:e.defaultValues);return(0,A.jsx)("div",{className:"attribute-section",children:(0,A.jsxs)(d.ZP,{container:!0,spacing:3,alignItems:"center",children:[(0,A.jsx)(d.ZP,{item:!0,md:4,sm:6,xs:12,className:"font-medium",children:(0,A.jsxs)("span",{children:[null===e||void 0===e?void 0:e.name," ","Y"===(null===e||void 0===e?void 0:e.mandatory)?(0,A.jsx)("span",{className:p.spanRed,children:"*"}):""]})}),(0,A.jsxs)(d.ZP,{item:!0,md:8,sm:6,xs:12,children:["text"===(null===e||void 0===e?void 0:e.inputType)&&(0,A.jsx)(F.Z,{className:"mb-4 w-full ",color:null!==u&&void 0!==u&&u[o]?"warning":"",fullWidth:!0,size:"small",variant:"outlined",id:o,name:o,value:v,onChange:e=>{g(o,e.target.value)},type:"text",disabled:s,style:{marginBottom:"10px"}}),"select"===(null===e||void 0===e?void 0:e.inputType)&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{children:r[o]}),(0,A.jsxs)(T.Z,{disabled:s,value:v,onChange:e=>{g(o,e.target.value)},displayEmpty:!0,renderValue:l=>l?(null===e||void 0===e?void 0:e.values.length)&&(null===e||void 0===e?void 0:e.values[0][l]):(0,A.jsx)("em",{children:"--Select--"}),style:{height:"37.13px",marginBottom:"1rem",width:"100%"},children:[(0,A.jsx)(S.Z,{id:"",children:"Select"}),(null===e||void 0===e?void 0:e.values.length)&&Object.keys(null===e||void 0===e?void 0:e.values[0]).map((l=>(0,A.jsx)(S.Z,{value:l,children:null===e||void 0===e?void 0:e.values[0][l]},f().generate())))]})]}),"checkbox"===(null===e||void 0===e?void 0:e.inputType)&&(0,A.jsx)(A.Fragment,{children:null===e||void 0===e?void 0:e.values.map(((e,l)=>(0,A.jsx)("div",{children:(0,A.jsx)(B.Z,{value:e,label:e,labelPlacement:"end",control:(0,A.jsx)($.Z,{})})},f().generate())))}),"radio"===(null===e||void 0===e?void 0:e.inputType)&&(0,A.jsx)(V.Z,{row:!0,name:o,sx:{mb:2},value:null!==(i=r[o])&&void 0!==i?i:"",onChange:e=>{g(o,e.target.value)},style:{display:"flex"},children:null===e||void 0===e?void 0:e.values.map(((e,l)=>(0,A.jsx)("div",{children:(0,A.jsx)(B.Z,{value:e,label:e,labelPlacement:"end",control:(0,A.jsx)(_.Z,{color:"secondary"})})},f().generate())))}),(0,A.jsx)("div",{style:{textAlign:"left",color:"red",position:"relative",top:"-15px"},children:null===u||void 0===u?void 0:u[o]})]})]})})})):(0,A.jsx)("div",{children:"No attributes found."})})})}})})),W=()=>{var e;const{selectedRowData:l,selectedRowFormdata:t,responseData:o,showMaterialForm:n}=(0,j.v9)((e=>{var l,t,i,o;return{selectedRowData:null===e||void 0===e||null===(l=e.mcoDetails)||void 0===l?void 0:l.selectedRowData,selectedRowFormdata:null===e||void 0===e||null===(t=e.mcoDetails)||void 0===t?void 0:t.selectedRowFormdata,responseData:null===e||void 0===e||null===(i=e.mcoDetails)||void 0===i?void 0:i.responseData,showMaterialForm:null===e||void 0===e||null===(o=e.mcoDetails)||void 0===o?void 0:o.showMaterialForm}}),j.wU),a=(0,j.I0)(),d=(0,i.useRef)({});return(0,A.jsxs)(v.Z,{open:n,onClose:()=>{a((0,O.$V)({showMaterialForm:!1}))},scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",maxWidth:"md",fullWidth:!0,children:[(0,A.jsx)(c.Z,{id:"scroll-dialog-title",children:"Material Details"}),(0,A.jsx)(p.Z,{dividers:!0,children:(0,A.jsx)(m.Z,{id:"scroll-dialog-description",tabIndex:-1,children:(0,A.jsx)(G,{ref:d,saveMaterialDetails:async e=>{const t=await(async()=>{var e,l;const t=P.y.getState(),i=(null===t||void 0===t||null===(e=t.mcoDetails)||void 0===e?void 0:e.responseData)||{},o=(null===t||void 0===t||null===(l=t.mcoDetails)||void 0===l?void 0:l.affectedPartsData)||[];return null!==o&&void 0!==o&&o.length?o||[]:(null===i||void 0===i?void 0:i.mcoaffectedItem)||[]})(),i=[...t],o=i.findIndex(((e,t)=>(null===l||void 0===l?void 0:l.id)===e.id));i[o].materialType={name:i[o].materialType.name,attributeMap:e},a((0,O.$V)({affectedPartsData:i,isMaterialFormEdited:!0,showMaterialForm:!1}))}})})}),(0,A.jsxs)(h.Z,{children:[(0,A.jsx)(s.Z,{onClick:()=>{a((0,O.$V)({showMaterialForm:!1}))},children:"Cancel"}),(0,A.jsx)(s.Z,{onClick:()=>{d.current.callsubmitForm()},disabled:["Review","Release","Implemented"].includes(null===o||void 0===o||null===(e=o.mcoaffectedItem)||void 0===e?void 0:e.mcostate)||!Object.keys(t||{}).length,children:"Save"})]})]})};var z=t(57289);const K=[{label:"Yes",value:!0},{label:"No",value:!1}],Y=[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],X=[{label:"Make",value:"make"},{label:"Buy",value:"buy"}];function J(e){return e&&""!==e?e:"--"}const Q=[{width:50,label:"Old\nRev",dataKey:"oldRevision",textAlign:"center"},{width:50,label:"New\nRev",dataKey:"newRevision",textAlign:"center"},{width:"20ch",label:"Type",dataKey:"type"},{width:"25ch",label:"Part Name",dataKey:"name"},{width:"30ch",label:"Description",dataKey:"description",textAlign:"left"},{width:"30ch",label:"Material Type Template",dataKey:"materialTypeTemplate",textAlign:"center"},{width:90,label:"Make-Buy",dataKey:"makeOrBuy",textAlign:"center"},{width:80,label:"Export\nStatus",dataKey:"ErpStatus",textAlign:"center"},{width:80,label:"Export \nTo ERP",dataKey:"exportToERP",textAlign:"center"},{width:80,label:"Sequence",dataKey:"currentSequence",textAlign:"center"},{width:100,label:"Item Status",dataKey:"ERPStatus",textAlign:"left"},{width:120,label:"Actions",dataKey:"actions",textAlign:"center"}],ee={};Q.forEach((e=>{ee[e.dataKey]=e.width}));const le=i.memo((e=>{var l,t,o,n,a,d,r,u,v,c,p,m,h,x,f,y,g,b,w,P,O,E,R,k,D,I,M,Z,L,F;let{row:B,rowIndex:$,dropdownOpts:V,handleIconClick:_}=e;const{responseData:U,masterData:q,materialData:H,mrDetails:G,eachTemplateOptions:W,affectedPartsData:Q,parentMCODetails:le}=(0,j.v9)((e=>{var l,t,i,o,n,a,d;return{responseData:null===(l=e.mcoDetails)||void 0===l?void 0:l.responseData,masterData:null===(t=e.mcoDetails)||void 0===t?void 0:t.masterData,materialData:null===(i=e.mcoDetails)||void 0===i?void 0:i.materialData,mrDetails:null===(o=e.mcoDetails)||void 0===o?void 0:o.mrDetails,eachTemplateOptions:null===(n=e.mcoDetails)||void 0===n?void 0:n.eachTemplateOptions,affectedPartsData:null===(a=e.mcoDetails)||void 0===a?void 0:a.affectedPartsData,parentMCODetails:null===(d=e.mcoDetails)||void 0===d?void 0:d.parentMCODetails}}),j.wU),[te,ie]=(0,i.useState)(B||{});let oe=(0,z.TB)(te),ne=!1;q&&Object.keys(q).length&&null!==q&&void 0!==q&&q.plantName.includes("SAP")&&(ne=Object.keys(q).length&&"N"===(null===q||void 0===q?void 0:q.master)),["Review","Release","Implemented","Complete"].includes(null===U||void 0===U||null===(l=U.mcoPropeties)||void 0===l?void 0:l.mcostate)&&(ne=!0),Object.keys(oe||{}).length&&(null===(t=oe)||void 0===t?void 0:t.desc)===(null===te||void 0===te||null===(o=te.attributeGroupData)||void 0===o?void 0:o.ERPItemTypeTemplate)&&(ne=!0);let ae=(null===U||void 0===U?void 0:U.itemERPStatus)&&(null===U||void 0===U?void 0:U.itemERPStatus.filter((e=>(null===e||void 0===e?void 0:e.Item_Name)===(null===te||void 0===te?void 0:te.name))));ae=null!==(n=ae)&&void 0!==n&&n.length?null===(a=ae[0])||void 0===a?void 0:a.status:"Not yet processed!";const de=(0,z.rA)(oe);let se=(null===W||void 0===W?void 0:W[null===te||void 0===te?void 0:te.name])||[];null!==(d=Object.keys(V))&&void 0!==d&&d.length&&null!==(r=Object.keys(V))&&void 0!==r&&r.includes(null===te||void 0===te?void 0:te.name)&&(se=V[null===te||void 0===te?void 0:te.name]);const re=(null===(u=se)||void 0===u?void 0:u.find((e=>(null===e||void 0===e?void 0:e.id)===oe.id)))||{};if((null===(v=Object.keys(re))||void 0===v||!v.length)&&null!==(c=Object.keys(oe))&&void 0!==c&&c.length){let e=null===H||void 0===H?void 0:H.find((e=>{var l;return(null===(l=oe)||void 0===l?void 0:l.Name)===e.templateName}));e&&(se=[...se,e])}const ue=null!==(p=Object.keys(G))&&void 0!==p&&p.length&&null!==G&&void 0!==G&&null!==(m=G.activeMR)&&void 0!==m&&m.hasOwnProperty(null===te||void 0===te?void 0:te.name)&&null!==G&&void 0!==G&&null!==(h=G.activeMR[null===te||void 0===te?void 0:te.name])&&void 0!==h&&h.length?null===G||void 0===G?void 0:G.activeMR[null===te||void 0===te?void 0:te.name][0]:{},ve=null!==(x=Object.keys(G))&&void 0!==x&&x.length&&null!==G&&void 0!==G&&null!==(f=G.activeMR)&&void 0!==f&&f.hasOwnProperty(null===te||void 0===te?void 0:te.name)&&null!==G&&void 0!==G&&null!==(y=G.previousSeqMR[null===te||void 0===te?void 0:te.name])&&void 0!==y&&y.length?null===G||void 0===G?void 0:G.previousSeqMR[null===te||void 0===te?void 0:te.name][0]:{},ce=(null===(g=se)||void 0===g?void 0:g.find((e=>{var l;return(null===e||void 0===e?void 0:e.id)===(null===(l=oe)||void 0===l?void 0:l.id)})))||{};if(null===(b=Object.keys(ce))||void 0===b||!b.length){let e=null===H||void 0===H?void 0:H.find((e=>(null===ue||void 0===ue?void 0:ue.template)===e.templateName));!e||null!==te&&void 0!==te&&te.isTemplateValueChange||(se=[...se,e],oe=e)}let pe={};if(null!==(w=Object.keys(ve||{}))&&void 0!==w&&w.length){var me;let e=(null===H||void 0===H?void 0:H.find(((e,l)=>(null===e||void 0===e?void 0:e.templateName)===(null===ve||void 0===ve?void 0:ve.template))))||{};null!==(me=Object.keys(e))&&void 0!==me&&me.length&&(se.push(e),null!==te&&void 0!==te&&te.isTemplateValueChange||(pe=e))}if((null===(P=Object.keys(oe||{}))||void 0===P||!P.length)&&(null===te||void 0===te||!te.isTemplateValueChange)){var he,xe,fe,ye;const e=(null===(he=se)||void 0===he?void 0:he.find((e=>(null===e||void 0===e?void 0:e.templateName)===(null===ve||void 0===ve?void 0:ve.template))))||{};null!==(xe=Object.keys(e))&&void 0!==xe&&xe.length||null===(fe=Object.keys(pe))||void 0===fe||!fe.length?null!==(ye=Object.keys(e))&&void 0!==ye&&ye.length&&(oe=e):oe=pe}let ge=null===te||void 0===te||null===(O=te.makeOrBuy)||void 0===O?void 0:O.toLowerCase(),be=null===te||void 0===te?void 0:te.exportToERP,we=null===te||void 0===te||null===(E=te.itemStatus)||void 0===E?void 0:E.toLowerCase();var je;(ge||null!==te&&void 0!==te&&te.isMakeOrBuyValueChange||(ge=null===ue||void 0===ue?void 0:ue.makeOrBuy),we||null!==te&&void 0!==te&&te.isItemStatusValueChange)||(we=null===ue||void 0===ue||null===(je=ue.ERPStatus)||void 0===je?void 0:je.toLowerCase());if(null!==(R=se)&&void 0!==R&&R.length){let e=[...se].filter(((e,l,t)=>t.indexOf(e)===l));se=e}let Pe=!1;if(null!==(k=Object.keys(le))&&void 0!==k&&k.length){var Oe,Ee,Ce;let e=(null===le||void 0===le||null===(Oe=le.mcoaffectedItem)||void 0===Oe?void 0:Oe.find((e=>(null===e||void 0===e?void 0:e.name)===(null===B||void 0===B?void 0:B.name))))||{};Object.keys(e||{}).length&&(null===e||void 0===e||null===(Ee=e.materialType)||void 0===Ee||null===(Ce=Ee.name)||void 0===Ce?void 0:Ce.length)>0&&(Pe=!0)}return null!==U&&void 0!==U&&null!==(D=U.mcoProperties)&&void 0!==D&&null!==(I=D.name)&&void 0!==I&&I.includes("MVO")&&(Pe=!0),(0,i.useEffect)((()=>{(async()=>{let e=B;null!==Q&&void 0!==Q&&Q.length&&(e=null===Q||void 0===Q?void 0:Q.find((e=>e.id===(null===B||void 0===B?void 0:B.id)))),ie(e)})()}),[B]),(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.oldRevision,paddingLeft:"20px"},children:J(null===te||void 0===te?void 0:te.oldRevision)}),(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.newRevision},children:J(null===te||void 0===te?void 0:te.newRevision)}),(0,A.jsx)(C.Z,{style:{textAlign:"left",width:null===ee||void 0===ee?void 0:ee.type},children:J(null===te||void 0===te?void 0:te.displayType)}),(0,A.jsx)(C.Z,{style:{textAlign:"left",minWidth:null===ee||void 0===ee?void 0:ee.name,maxWidth:"340px"},children:J(null===te||void 0===te?void 0:te.name)}),(0,A.jsx)(C.Z,{style:{textAlign:"left",width:null===ee||void 0===ee?void 0:ee.description},children:J(null===te||void 0===te?void 0:te.description)}),(0,A.jsxs)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.materialTypeTemplate},children:[(0,A.jsx)("span",{children:(0,A.jsxs)(T.Z,{disabled:ne,className:"form-control customSelectCss",value:(null===(M=oe)||void 0===M?void 0:M.id)||"",onChange:e=>{(0,z.uj)(e.target.value,null===B||void 0===B?void 0:B.id,"template")},style:{width:"100%"},displayEmpty:!0,title:de||null,renderValue:e=>{var l;const t=null===(l=se)||void 0===l?void 0:l.find((l=>l.id===e));return null!==t&&void 0!==t&&t.templateName?t.templateName:"Unassigned"},children:[(0,A.jsx)(S.Z,{value:"",children:"Unassigned"}),null===(Z=se)||void 0===Z?void 0:Z.map(((e,l)=>{const t="dpKey"+l;return(0,A.jsx)(S.Z,{value:e.id,children:e.templateName?e.templateName:""},t)}))]})}),null!==(L=se)&&void 0!==L&&L.length?(0,A.jsx)(A.Fragment,{}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("br",{}),(0,A.jsx)("span",{style:{color:"red"},children:Pe?"Template not available!":"MVO is required to be set first"})]})]}),(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.makeBuy},children:(0,A.jsx)(T.Z,{disabled:!0,className:"form-control customSelectCss",value:ge,onChange:e=>(0,z.uj)(e.target.value,null===B||void 0===B?void 0:B.id,"makeOrBuy"),style:{width:"100%"},displayEmpty:!0,renderValue:e=>{const l=null===X||void 0===X?void 0:X.find((l=>l.value===e));return null===l||void 0===l?void 0:l.label},children:null===X||void 0===X?void 0:X.map(((e,l)=>{const t="dpKeyMakeBuy"+l;return(0,A.jsx)(S.Z,{value:e.value,children:e.label},t)}))})}),(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.exportStatus},children:(0,A.jsx)(N,{colorCode:"red",status:ae})}),(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.exportToERP},children:(0,A.jsx)(T.Z,{disabled:!0,className:"form-control customSelectCss",value:be,onChange:e=>(0,z.uj)(e.target.value,null===B||void 0===B?void 0:B.id,"exportToERP"),style:{width:"100%"},displayEmpty:!0,renderValue:e=>{const l=null===K||void 0===K?void 0:K.find((l=>l.value===e));return null===l||void 0===l?void 0:l.label},children:null===K||void 0===K?void 0:K.map(((e,l)=>{const t="dpKey2"+l;return(0,A.jsx)(S.Z,{value:e.value,children:e.label},t)}))})}),(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.currentSequence},children:J(null===te||void 0===te?void 0:te.currentSequence)}),(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.itemStatus},children:(0,A.jsx)(T.Z,{disabled:!0,className:"form-control customSelectCss",value:we,onChange:e=>(0,z.uj)(e.target.value,null===B||void 0===B?void 0:B.id,"itemStatus"),style:{width:"100%"},displayEmpty:!0,renderValue:e=>{const l=null===Y||void 0===Y?void 0:Y.find((l=>l.value===e));return null===l||void 0===l?void 0:l.label},children:null===Y||void 0===Y?void 0:Y.map(((e,l)=>{const t="dpKey3"+l;return(0,A.jsx)(S.Z,{value:e.value,children:e.label},t)}))})}),null!==U&&void 0!==U&&null!==(F=U.mcoPropeties)&&void 0!==F&&F.organizationId.includes("SAP")?(0,A.jsx)(C.Z,{style:{textAlign:"center",width:null===ee||void 0===ee?void 0:ee.actions},children:(0,A.jsx)(s.Z,{onClick:async e=>{await _(te,H,"form",U)},children:(0,A.jsx)("span",{role:"img","aria-label":"Open Form",children:"\ud83d\udcdd"})})}):null]})}),((e,l)=>e.row===l.row&&e.rowIndex===l.rowIndex)),te=i.memo((e=>{const{responseData:l}=(0,j.v9)((e=>{var l;return{responseData:null===(l=e.mcoDetails)||void 0===l?void 0:l.responseData}}),j.wU),[t,o]=(0,i.useState)({}),[n,a]=(0,i.useState)({key:"name",direction:"asc"}),[d,s]=(0,i.useState)((null===l||void 0===l?void 0:l.mcoaffectedItem)||[]),r=(0,i.useRef)(null),u=(0,j.I0)(),v=localStorage.getItem("instance"),c={Scroller:i.forwardRef(((e,l)=>(0,A.jsx)(R.Z,{component:k.Z,...e,ref:l,className:"affTableContainer"}))),Table:e=>(0,A.jsx)(D.Z,{...e,sx:{borderCollapse:"separate"}}),TableHead:I.Z,TableRow:e=>{let{item:l,...t}=e;return(0,A.jsx)(M.Z,{...t})},TableBody:i.forwardRef(((e,l)=>(0,A.jsx)(Z.Z,{...e,ref:l})))};return(0,i.useEffect)((()=>{setTimeout((()=>{(async()=>{var e;if(null!==(e=window)&&void 0!==e&&e.ExternalClass){const e=new window.ExternalClass({affectedItemsInfo:l}),t=await e.getDropdownOptions();o(t)}else console.error("ExternalClass class is not defined.")})()}),100)}),[]),(0,i.useEffect)((()=>{const e=(0,z.ul)(n);s(e),u((0,O.$V)({exportAffectedPartsData:e}))}),[n,l]),(0,A.jsxs)("div",{className:"partsTableSty",children:[d.length?(0,A.jsx)(k.Z,{className:"height100Per",children:(0,A.jsx)(L._n,{ref:r,data:d,components:c,fixedHeaderContent:function(){return(0,A.jsx)(M.Z,{children:Q.filter((e=>{var t,i;return"actions"!==e.dataKey&&"onPrem"===v?null===l||void 0===l||null===(t=l.mcoPropeties)||void 0===t?void 0:t.organizationId.includes("ORACLE"):null===l||void 0===l||null===(i=l.mcoPropeties)||void 0===i?void 0:i.organizationId.includes("SAP")})).map((e=>{var t;let i=e.label;"materialTypeTemplate"===(null===e||void 0===e?void 0:e.dataKey)&&null!==l&&void 0!==l&&null!==(t=l.mcoPropeties)&&void 0!==t&&t.organizationId.includes("SAP")?i="Material Type Template":"materialTypeTemplate"===(null===e||void 0===e?void 0:e.dataKey)&&(i="Template");let o={textAlign:e.textAlign,width:e.width,paddingLeft:"oldRevision"===(null===e||void 0===e?void 0:e.dataKey)?"20px":""};return"name"===e.dataKey&&(o={textAlign:e.textAlign,width:e.width}),(0,A.jsxs)(C.Z,{style:o,sx:{backgroundColor:"background.paper",cursor:"pointer"},onClick:()=>{return l=e.dataKey,void a((e=>({key:l,direction:"asc"===e.direction?"desc":"asc"})));var l},children:[i,n.key===e.dataKey?(0,A.jsx)("span",{children:"asc"===n.direction?" \u2191":" \u2193"}):null]},e.dataKey)}))})},itemContent:(l,i)=>(0,A.jsx)(le,{row:i,rowIndex:l,dropdownOpts:t,handleIconClick:null===e||void 0===e?void 0:e.handleIconClick})})}):(0,A.jsx)("div",{style:{textAlign:"center"},children:"No parts available!"}),(0,A.jsx)(W,{})]})})),ie=te;var oe=t(36314),ne=t(63875),ae=t(74512),de=t(50533),se=t(54869);const re="Promote >>",ue="<< Demote";function ve(e){var l,t,o,n,a,s;const{responseData:r,lifeCycleData:u}=(0,j.v9)((e=>{var l;return{responseData:null===(l=e.mcoDetails)||void 0===l?void 0:l.responseData,lifeCycleData:e.mcoDetails.lifeCycleData}}),j.wU),{stepData:v,lifeCycleStep:c}=e,[p,m]=(0,i.useState)("Create");let h=[];return h="SaaS"===localStorage.getItem("instance")?["Prepare","In Work","In Approval","Approved","Complete"]:["Create","Review","Release","Implemented"],(0,i.useEffect)((()=>{m(v)}),[v]),(0,A.jsx)(d.ZP,{item:!0,md:12,sm:12,xs:12,className:"font-medium",children:(0,A.jsx)("div",{className:"",style:{margin:"auto auto 25px auto",textAlign:"center",width:"75%",position:"relative"},children:(0,A.jsxs)(oe.Z,{sx:{width:"100%"},spacing:4,children:["review"!==(null===r||void 0===r||null===(l=r.mcoPropeties)||void 0===l||null===(t=l.mcostate)||void 0===t?void 0:t.toLowerCase())||"inprogress"!==(null===u||void 0===u||null===(o=u[null===r||void 0===r||null===(n=r.mcoPropeties)||void 0===n?void 0:n.name])||void 0===o?void 0:o.promoted)&&!["Item","BOM"].includes(c)?null:(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(se.Z,{title:null===u||void 0===u||null===(a=u[null===r||void 0===r||null===(s=r.mcoPropeties)||void 0===s?void 0:s.name])||void 0===a?void 0:a.promoted})}),(0,A.jsx)(ne.Z,{alternativeLabel:!0,activeStep:1,style:{marginTop:"0px"},children:h.map(((l,t)=>(0,A.jsxs)(ae.Z,{children:[p===l?(0,A.jsxs)("div",{style:{width:"auto",minWidth:"110px",display:"inline-table",padding:"10px",color:"#ffffff",background:"#42a2da",zIndex:"1",position:"relative",top:"-10px",borderRadius:"-10px",boxShadow:"0px 2px 2px 0px rgba(0, 0, 0, 0.3)"},"data-state":l,children:[0!==t&&(0,A.jsx)("span",{style:{width:"0",height:"0",borderStyle:"solid",borderTop:"7px solid transparent",borderBottom:"7px solid transparent",borderLeft:"10px solid #bdbdbd",borderRight:"0",position:"absolute",left:"-10px",top:"15.5px"}}),l]}):(0,A.jsxs)("div",{style:{width:"auto",minWidth:"110px",display:"inline-table",padding:"10px",color:"#5c5c5c",background:"#e6e7e8",zIndex:"1",position:"relative",top:"-10px",borderRadius:"-10px",boxShadow:"0px 2px 2px 0px rgba(0, 0, 0, 0.3)"},"data-state":l,children:[0!==t&&(0,A.jsx)("span",{style:{width:"0",height:"0",borderStyle:"solid",borderTop:"7px solid transparent",borderBottom:"7px solid transparent",borderLeft:"10px solid #bdbdbd",borderRight:"0",position:"absolute",left:"-10px",top:"15.5px"}}),l]}),p===l&&(0,A.jsxs)("div",{children:[!["Item","BOM"].includes(c)&&["Release"].includes(p)&&(0,A.jsx)(de.Z,{component:"button",variant:"body2",underline:"none",title:re,onClick:()=>{e.handleLifeCycle(l,"promote")},children:re}),["Item","BOM"].includes(c)&&["Review","Release","Implemented","In Work","In Approval","Approved"].includes(p)&&(0,A.jsx)(de.Z,{component:"button",variant:"body2",underline:"none",title:re,style:{color:"lightgrey"},children:re}),!["Item","BOM"].includes(c)&&["Review","In Work","In Approval","Approved"].includes(p)&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{children:(0,A.jsx)(de.Z,{component:"button",variant:"body2",underline:"none",title:re,onClick:()=>{e.handleLifeCycle(l,"promote")},children:re})}),(0,A.jsx)("div",{children:(0,A.jsx)(de.Z,{component:"button",variant:"body2",underline:"none",title:ue,onClick:()=>{e.demoteState(l,"demote")},children:ue})})]}),["Create","Prepare"].includes(p)&&(0,A.jsx)(de.Z,{component:"button",variant:"body2",underline:"none",title:re,onClick:()=>{e.handleLifeCycle(l,"promote")},children:re})]})]},l)))})]})})})}var ce=t(48527),pe=t(49644),me=t(71652),he=t(24750),xe=t(26614),fe=t(97892),ye=t.n(fe),ge=t(96171),be=t(65077);t(93270);const we=e=>e&&e[0].toUpperCase()+e.slice(1),je=localStorage.getItem("instance"),Pe={startDate:"Startdate",rme:"onPrem"===je?"Responsible Manufacturing Engineer":"",rsme:"onPrem"===je?"Responsible Senior Manufacturing Engineer":"",mcostate:"State",responseFromErp:"Export Status",plantName:"Plant",businessUnit:"Design Organization",description:"Description",ECOExportToERP:"ECO Export To ERP"},Oe=e=>{let{plantType:l,selectedRoute:t}=e;const o=(0,j.I0)(),{responseData:a,RSMEList:d,RMEList:s,currentMcoDetails:r,isPropertyFormEdited:u}=(0,j.v9)((e=>e.mcoDetails)),[v,c]=(0,i.useState)({}),[p,m]=(0,i.useState)(!1),[h,x]=(0,i.useState)(null);return(0,i.useEffect)((()=>{!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",l={};if(Object.keys((null===a||void 0===a?void 0:a.mcoPropeties)||{}).length){var t,i;const e=null===a||void 0===a?void 0:a.mcoPropeties;if(e.startdate){let t=new Date;t.setHours(0,0,0,0);let i=e.startdate.split(/[\s/:]+/);new Date(i[2],i[0]-1,i[1],i[3],i[4],i[5])<t&&(l.startdate=`${Pe.startDate} must be a present or future date`)}else l.startdate=`${Pe.startDate} is required`;e.rme&&"unassigned"!==(null===(t=e.rme)||void 0===t?void 0:t.toLowerCase())||"onPrem"!==je||(l.rme=`${Pe.rme} is required`),(!e.rsme||"unassigned"===(null===(i=e.rsme)||void 0===i?void 0:i.toLowerCase())&&"onPrem"===je)&&(l.rsme=`${Pe.rsme} is required`),e.description||(l.description=`${Pe.description} is required`),e.ECOExportToERP||(l.ECOExportToERP=`${Pe.ECOExportToERP} is required`)}if(c(l),Object.keys(l||{}).length){var o;const t=null===(o=Object.keys(l||{}))||void 0===o?void 0:o.map((e=>(0,A.jsx)("li",{children:l[e]},f().generate())));"click"===e&&(m(!0),x({severity:"error",desc:t}))}}()}),[a]),(0,A.jsxs)(A.Fragment,{children:[Object.keys((null===a||void 0===a?void 0:a.mcoPropeties)||{}).map((e=>{var i,u,c,p,m,h,x,y,g,b,w,j,P,E,C,R;if(["id","type","physicalid","organizationId","rmeEmailAddress","rsmeEmailAddress","startDateDisplayValue","errorMsg"].includes(e)||"responseFromErp"===e&&(!r||null===r||void 0===r||!r.ERPstatus||!r))return!1;let k=null;var D;["rme","rsme"].includes(e)&&"onPrem"===je&&(k=null===(D=("rme"===e?s:d)||[])||void 0===D?void 0:D.find((l=>l.key===(null===a||void 0===a?void 0:a.mcoPropeties[e]))));let I=null===a||void 0===a||null===(i=a.mcoPropeties)||void 0===i?void 0:i.ECOExportToERP;if("ECOExportToERP"===e&&(null===a||void 0===a||null===(u=a.mcoPropeties)||void 0===u||!u.ECOExportToERP||""===(null===a||void 0===a||null===(c=a.mcoPropeties)||void 0===c?void 0:c.ECOExportToERP))){let e=null===a||void 0===a?void 0:a.mcoPropeties;e.ECOExportToERP="yes",o((0,O.qH)({mcoPropeties:e}))}const M=!(null!==(p=["Create","Review","Prepare","In Work"])&&void 0!==p&&p.includes(null===a||void 0===a||null===(m=a.mcoPropeties)||void 0===m?void 0:m.mcostate));return(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)(ce.Z,{container:!0,spacing:3,alignItems:"center",children:[(0,A.jsx)(ce.Z,{item:!0,md:3,sm:4,xs:12,className:"font-medium",children:["startdate"].includes(e)&&null!==a&&void 0!==a&&null!==(h=a.mcoPropeties)&&void 0!==h&&h.startDateDisplayValue&&"null"!==(null===a||void 0===a||null===(x=a.mcoPropeties)||void 0===x?void 0:x.startDateDisplayValue)?(0,A.jsx)("span",{style:{position:"relative",top:"-25px"},children:Object.keys(Pe||{}).includes(e)?we(Pe[e]):we(e)}):(0,A.jsx)("span",{children:Object.keys(Pe||{}).includes(e)?we(Pe[e]):we(e)})}),(0,A.jsxs)(ce.Z,{item:!0,md:9,sm:8,xs:12,children:[["startdate"].includes(e)&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(me._,{dateAdapter:he.y,children:(0,A.jsx)(xe.x,{disabled:M,minDate:ye()(),views:["year","month","day"],value:a.mcoPropeties[e]&&""!==a.mcoPropeties[e]?ye()(a.mcoPropeties[e]):null,onChange:e=>{let l=null===a||void 0===a?void 0:a.mcoPropeties;if(e){let t=ye()(e.$d).format("MM/DD/YYYY hh:mm:ss A");"Invalid Date"!==t?(l.startdate=null!==t&&void 0!==t?t:null,o((0,O.qH)({mcoPropeties:l}))):e||(l.startdate=e,o((0,O.qH)({mcoPropeties:l}))),o((0,O.$V)({isPropertyFormEdited:!0}))}else e||(l.startdate=e,o((0,O.qH)({mcoPropeties:l})))},className:`datatimeInputCls ${null===a||void 0===a||null===(y=a.mcoPropeties)||void 0===y?void 0:y.mcostate}`,sx:{padding:"0px!important",width:"100%!important",marginBottom:"1rem !important","@global":{input:{padding:"8.5px 14px!important",height:"0.4375em!important"}}},slots:{toolbar:be.Z}})}),null!==a&&void 0!==a&&null!==(g=a.mcoPropeties)&&void 0!==g&&g.startDateDisplayValue&&"null"!==(null===a||void 0===a||null===(b=a.mcoPropeties)||void 0===b?void 0:b.startDateDisplayValue)?(0,A.jsx)(A.Fragment,{children:(0,A.jsxs)("div",{style:{padding:"0px 15px 15px 0px"},children:[(0,A.jsx)("b",{children:"Start Date Equivalent To:"})," ",null===a||void 0===a||null===(w=a.mcoPropeties)||void 0===w?void 0:w.startDateDisplayValue]})}):null]}),["rme","rsme"].includes(e)&&"onPrem"===je&&(0,A.jsx)(pe.Z,{disabled:M,id:"autoComplete_"+e,value:(null===(j=k)||void 0===j?void 0:j.label)||null,autoHighlight:!0,onChange:(l,t)=>{let i=a.mcoPropeties;i[e]=t&&t.key||null,o((0,O.qH)({mcoPropeties:i})),o((0,O.$V)({isPropertyFormEdited:!0}))},onInputChange:(e,l)=>{},options:"rme"===e?s:d,renderInput:l=>(0,A.jsx)(F.Z,{...l,className:null!==v&&void 0!==v&&v[e]?"errorAutocomplete":""}),renderOption:(e,l)=>(0,A.jsx)(n.Z,{component:"li",sx:{"& > img":{mr:2,flexShrink:0}},...e,children:l.label})}),["responseFromErp"].includes(e)&&r&&(0,A.jsx)(F.Z,{fullWidth:!0,className:"mb-4 w-full "+(null!==v&&void 0!==v&&v[e]?"error-border":""),size:"small",variant:"outlined",name:e,value:null!==(P=null===r||void 0===r?void 0:r.ERPstatus)&&void 0!==P?P:"",type:"text",disabled:["responseFromErp"].includes(e)}),["ECOExportToERP"].includes(e)&&r&&(0,A.jsxs)(T.Z,{disabled:M,className:null!==v&&void 0!==v&&v[e]?"error-border":"",value:null!==I&&void 0!==I?I:"yes",onChange:e=>{let l=null===a||void 0===a?void 0:a.mcoPropeties;l.ECOExportToERP=e.target.value||null,o((0,O.qH)({mcoPropeties:l})),o((0,O.$V)({isPropertyFormEdited:!0}))},displayEmpty:!0,renderValue:e=>e?we(I||"yes"):(0,A.jsx)("em",{children:"--Select--"}),style:{height:"37.13px",marginBottom:"1rem",width:"100%"},children:[(0,A.jsx)(S.Z,{id:"",children:"Select"}),["yes","no"].map((e=>(0,A.jsx)(S.Z,{value:e,children:we(e)},f().generate())))]}),!["startdate","rme","rsme","responseFromErp","ECOExportToERP"].includes(e)&&(0,A.jsx)(F.Z,{className:null!==v&&void 0!==v&&v[e]?"error-border":"",fullWidth:!0,size:"small",variant:"outlined",name:e,value:"plantName"===e?l:"name"===e?(null===t||void 0===t?void 0:t.title)||"":null!==(E=null===a||void 0===a?void 0:a.mcoPropeties[e])&&void 0!==E?E:"",onChange:e=>{let l=a.mcoPropeties;["name","originator","businessUnit","mcostate","plantName","organizationId"].includes(e.target.name)||(l[e.target.name]=e.target.value||null,o((0,O.qH)({mcoPropeties:l})),o((0,O.$V)({isPropertyFormEdited:!0})))},type:"text",disabled:["name","originator","businessUnit","mcostate","plantName","organizationId"].includes(e)||M})]}),["responseFromErp"].includes(e)&&r&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(ce.Z,{item:!0,md:3,sm:4,xs:12,className:"font-medium",children:(0,A.jsx)("span",{})}),(0,A.jsx)(ce.Z,{item:!0,md:9,sm:8,xs:12,style:{padding:"0px"},children:r&&"success"!==(null===r||void 0===r||null===(C=r.ERPstatus)||void 0===C?void 0:C.toLowerCase())?(0,A.jsx)(A.Fragment,{children:(null===r||void 0===r?void 0:r.ERPErrorDescription)instanceof Array?(0,A.jsx)(A.Fragment,{children:(0,A.jsx)("ul",{children:null===r||void 0===r||null===(R=r.ERPErrorDescription)||void 0===R?void 0:R.map((e=>(0,A.jsx)("li",{children:(0,z.qS)(e)},f().generate())))})}):(0,A.jsx)(A.Fragment,{children:(0,A.jsx)("ul",{children:(0,A.jsx)("li",{children:`${(0,z.qS)(null===r||void 0===r?void 0:r.ERPErrorDescription)}`},f().generate())})})}):null})]})]},e)})})),h&&(0,A.jsx)(ge.Z,{openAlert:p,openDesc:h,setOpenAlert:m})]})};var Ee=t(69383);var Ce;const Te=(Ce=e=>(0,A.jsxs)("div",{children:[(0,A.jsx)(s.Z,{variant:"contained",onClick:()=>null===e||void 0===e?void 0:e.bulkUploadPartandTemplate(),style:{position:"absolute",right:"165px",top:"0px",zIndex:1},disabled:["Review","Release","Implemented"].includes(null===e||void 0===e?void 0:e.stepData),children:"Upload Part Templates"}),(0,A.jsx)(s.Z,{variant:"contained",onClick:()=>null===e||void 0===e?void 0:e.exportMCOData(),style:{position:"absolute",right:"80px",top:"0px",zIndex:1},children:"Export"}),(0,A.jsx)(s.Z,{variant:"contained",onClick:()=>null===e||void 0===e?void 0:e.submitAffectedParts("form"),style:{position:"absolute",right:"0px",top:"0px",zIndex:1},disabled:["Review","Release","Implemented"].includes(null===e||void 0===e?void 0:e.stepData)||!(null!==e&&void 0!==e&&e.isMaterialFormEdited),children:"Save"})]}),e=>{const l=(0,j.v9)((e=>e.mcoDetails.isMaterialFormEdited));return(0,A.jsx)(Ce,{...e,isMaterialFormEdited:l})});var Se=t(13400),Re=t(29823);const ke=[{id:"createdDateTime",label:"Date",width:"120px"},{id:"actionUserDetails",label:"User",width:"120px"},{id:"actionType",label:"Action",width:"80px"},{id:"state",label:"State",width:"80px"},{id:"description",label:"Description",width:"400px"}];function De(){const[e,l]=(0,i.useState)([]),[t,o]=(0,i.useState)(!0),[n,a]=(0,i.useState)(null),d=new g.h,s=(0,b.UO)();return(0,i.useEffect)((()=>{(async()=>{try{await d.getMcoHistorybyid([null===s||void 0===s?void 0:s.mco_id]).then((async e=>{var t,i,n;console.log(e,"===histData"),"success"===(null===e||void 0===e?void 0:e.status)?null!==(t=Object.keys(null===e||void 0===e?void 0:e.data))&&void 0!==t&&t.length&&null!==(i=Object.keys(null===e||void 0===e?void 0:e.data))&&void 0!==i&&i.includes(null===s||void 0===s?void 0:s.mco_id)&&l(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n[null===s||void 0===s?void 0:s.mco_id]):a("No result found!"),o(!1)})).catch((e=>{throw e}))}catch(e){throw e}})()}),[]),(0,A.jsx)(k.Z,{sx:{maxWidth:"1200px",overflow:"hidden"},children:(0,A.jsxs)(R.Z,{sx:{maxHeight:440},children:[(0,A.jsxs)(D.Z,{stickyHeader:!0,"aria-label":"sticky table",style:{padding:"0px 10px 10px"},children:[(0,A.jsx)(I.Z,{children:(0,A.jsx)(M.Z,{children:ke.map((e=>(0,A.jsx)(C.Z,{align:e.align,style:{top:0,minWidth:e.minWidth,width:e.width},children:e.label},e.id)))})}),(0,A.jsx)(Z.Z,{children:null===e||void 0===e?void 0:e.map((e=>(0,A.jsx)(M.Z,{tabIndex:-1,children:ke.map((l=>{const t=e[l.id];return(0,A.jsx)(C.Z,{align:l.align,children:l.format&&"number"===typeof t?l.format(t):t},l.id)}))},e.code)))})]}),t?(0,A.jsx)("div",{style:{textAlign:"center"},children:(0,A.jsx)(w.Z,{show:t})}):null,n?(0,A.jsx)("div",{style:{textAlign:"center",padding:"10px 0px 20px"},children:n}):null]})})}const Ie=(0,o.ZP)(v.Z)((e=>{let{theme:l}=e;return{"& .MuiDialogContent-root":{padding:l.spacing(2)},"& .MuiDialogActions-root":{padding:l.spacing(1)}}}));function Me(e){let{showHistoryBox:l,setShowHistoryBox:t}=e;const[o,n]=i.useState(!1),a=(e,l)=>{"backdropClick"!==l&&"escapeKeyDown"!==l&&(n(!1),t(!1))};return(0,i.useEffect)((()=>{n(l)}),[l]),(0,A.jsx)(i.Fragment,{children:(0,A.jsxs)(Ie,{onClose:a,"aria-labelledby":"customized-dialog-title",open:o,maxWidth:"xl",children:[(0,A.jsx)(c.Z,{sx:{m:0,p:2},id:"customized-dialog-title",children:"History"}),(0,A.jsx)(Se.Z,{"aria-label":"close",onClick:a,sx:e=>({position:"absolute",right:8,top:8,color:e.palette.grey[500]}),children:(0,A.jsx)(Re.Z,{})}),(0,A.jsx)(p.Z,{dividers:!0,children:(0,A.jsx)(De,{})}),(0,A.jsx)(h.Z,{children:(0,A.jsx)(s.Z,{autoFocus:!0,onClick:a,children:"Close"})})]})})}const Ze=e=>{let{handleRefreshButtonFunc:l,responseData:t}=e;return(0,A.jsxs)("div",{className:"buttonRefreshContainer",children:[(0,A.jsx)(s.Z,{variant:"contained",title:"Refresh MCO data",onClick:()=>{l(!0,t)},className:"refreshBtn",children:"Refresh"}),(0,A.jsx)(s.Z,{variant:"contained",title:"Reload Affected Items",className:"reloadBtn",onClick:()=>{window.location.reload()},children:"Reload Affected Items"})]})},Ae=e=>{var l,t,i,o;let{responseData:n,setShowTrackerBox:a,setShowHistoryBox:d}=e;return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(de.Z,{component:"button",underline:"none",onClick:()=>{d(!0)},children:"History"}),(0,A.jsx)("span",{style:{padding:"10px"},children:"|"}),"create"===(null===n||void 0===n||null===(l=n.mcoPropeties)||void 0===l||null===(t=l.mcostate)||void 0===t?void 0:t.toLowerCase())?(0,A.jsx)(de.Z,{component:"button",underline:"none",disabled:!0,style:{color:"grey"},children:"Tracker"}):(0,A.jsx)(de.Z,{component:"button",underline:"none",onClick:()=>{a(!0)},disabled:"create"===(null===n||void 0===n||null===(i=n.mcoPropeties)||void 0===i||null===(o=i.mcostate)||void 0===o?void 0:o.toLowerCase()),children:"Tracker"})]})};var Ne=t(54343),Le=t(13286),Fe=t(23888);const Be=()=>{const{getTemplateMappingsFunc:e,getTemplateMappingsFuncForTypeAndBU:l}=(()=>{const{responseData:e,templateMappingsInfo:l,ORGAllowedTemplateMappings:t}=(0,j.v9)((e=>({responseData:e.mcoDetails.responseData,templateMappingsInfo:e.mcoDetails.templateMappingsInfo,ORGAllowedTemplateMappings:e.mcoDetails.ORGAllowedTemplateMappings})),j.wU);return{getTemplateMappingsFunc:i=>i?"ORGAllowedTemplateMappings"===i?(null===t||void 0===t?void 0:t.filter((l=>{var t;return l.BUID===(null===e||void 0===e||null===(t=e.mcoPropeties)||void 0===t?void 0:t.businessUnit)})))||[]:(null===l||void 0===l?void 0:l.filter((l=>{var t;return l.MappingType===i&&l.BUID===(null===e||void 0===e||null===(t=e.mcoPropeties)||void 0===t?void 0:t.businessUnit)})))||[]:[],getTemplateMappingsFuncForTypeAndBU:function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return i?"ORGAllowedTemplateMappings"===i?(null===t||void 0===t?void 0:t.filter((l=>{var t;return l.BUID===(null===e||void 0===e||null===(t=e.mcoPropeties)||void 0===t?void 0:t.businessUnit)})))||[]:(null===l||void 0===l?void 0:l.filter((e=>e.MappingType===i&&e.BUID===o)))||[]:[]}}})(),{responseData:t,templateList:i,mrDetails:o}=(0,j.v9)((e=>({responseData:e.mcoDetails.responseData,templateList:e.mcoDetails.templates,mrDetails:e.mcoDetails.mrDetails})),j.wU),n=function(l){let t=[];if(l&&"Unassigned"!==l){let p=null;switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:""){case"mvoallowedchanges":const m=e("mvoallowedchanges");var i,o,n;if(p=(null===m||void 0===m?void 0:m.filter((e=>{var t;return(null===e||void 0===e||null===(t=e.details)||void 0===t?void 0:t.MVO_TEMPLATE_FROM)===l})))||[],p.length)t=null===(i=p[0])||void 0===i||null===(o=i.details)||void 0===o||null===(n=o.MVO_TEMPLATES_TO)||void 0===n?void 0:n.map((e=>e.MVO_TEMPLATE_TO));break;case"mvoTemplateCompatibility":const h=e("mvoTemplateCompatibility");var a,d,s,r;if(p=(null===h||void 0===h?void 0:h.filter((e=>{var t;return(null===e||void 0===e||null===(t=e.details)||void 0===t?void 0:t.MVO_TEMPLATE_OPTION)===l})))||[],p.length)t=null===(a=p[0])||void 0===a||null===(d=a.details)||void 0===d||null===(s=d.allowableOrgTemplates)||void 0===s||null===(r=s.filter((e=>{var l;return"active"===(null===(l=e.status)||void 0===l?void 0:l.toLowerCase())})))||void 0===r?void 0:r.map((e=>e.ALLOWABLE_ORG_TEMPLATE));break;case"setcompatibletemplates":const x=e("setcompatibletemplates");var u,v,c;if(p=(null===x||void 0===x?void 0:x.filter((e=>{var t;return(null===e||void 0===e||null===(t=e.details)||void 0===t?void 0:t.TEMPLATE_ORG_EXISTING)===l})))||[],p.length)t=null===(u=p[0])||void 0===u||null===(v=u.details)||void 0===v||null===(c=v.TEMPLATE_ORG_MODIFYING)||void 0===c?void 0:c.map((e=>e.TEMPLATE_ORG_MODIFYING))}}return t},a=function(){var e;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t&&l&&null!==(e=Object.keys(l))&&void 0!==e&&e.includes(null===t||void 0===t?void 0:t.name)?l[null===t||void 0===t?void 0:t.name][0]:{}},d=e=>{var l;if(!e)return new Map;const t=new Map;let i="";return null===(l=Object.keys(e))||void 0===l||l.map((l=>{if(i=e[l],t.has(i)){const e=t.get(i);t.set(i,[...e,l])}else t.set(i,[l])})),t},s=function(){let e=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").find((e=>{var l;return"buplantmapping"===e.MappingType&&"NONE OR PO ORG"===(null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.Entity.toUpperCase())}));if(e&&Object.keys(e).length){var l;const t=null===(l=e.details)||void 0===l?void 0:l.PLANT;return Object.keys(t).forEach((e=>{"None"!==t[e]&&""!==t[e]||delete t[e]})),t}return{}}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);return d(e)};return async function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!r)return[];let u=[];const v=null===r||void 0===r?void 0:r.displayType,c=[];if((()=>{var e,l;return null===Le||void 0===Le||null===(e=Le.masterPlants)||void 0===e?void 0:e.includes(null===t||void 0===t||null===(l=t.mcoPropeties)||void 0===l?void 0:l.plantName)})()){var p,m;if((e=>{var l,t;let i=!1;const n=a(null===o||void 0===o?void 0:o.activeMR,e)||{},d=a(null===o||void 0===o?void 0:o.previousSeqMR,e)||{};return null!==(l=Object.keys(n))&&void 0!==l&&l.length&&null!==(t=Object.keys(d))&&void 0!==t&&t.length?(d&&(null===n||void 0===n?void 0:n.sequence)!==(null===d||void 0===d?void 0:d.sequence)&&(i=!0),i):i})(r)){if(null!==o&&void 0!==o&&null!==(p=o.previousSeqMR)&&void 0!==p&&p.hasOwnProperty(null===r||void 0===r?void 0:r.name)&&null!==o&&void 0!==o&&null!==(m=o.previousSeqMR[null===r||void 0===r?void 0:r.name])&&void 0!==m&&m.length){c.push("story 2");const e=a(null===o||void 0===o?void 0:o.previousSeqMR,r)||{};u=n(null===e||void 0===e?void 0:e.template,"mvoallowedchanges",r)}}else c.push("story 1"),u=function(l){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=null,n=[];switch(l){case"partTypeAndORGAllowed_TemplateMappings":const l=e("parttypetotemplate"),r=e("ORGAllowedTemplateMappings"),u=l.filter((e=>e.details.ENGG_ITEM_TYPE===i))||[],v=(null===r||void 0===r?void 0:r.filter((e=>{var l,i,o,n;return Object.keys(null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.Plants).includes(null===t||void 0===t||null===(i=t.mcoPropeties)||void 0===i?void 0:i.plantName)&&"Y"===(null===e||void 0===e||null===(o=e.details)||void 0===o?void 0:o.Plants[null===t||void 0===t||null===(n=t.mcoPropeties)||void 0===n?void 0:n.plantName])})))||[];let c=[];if(u.length)v.forEach((e=>{var l,t;((null===(l=u[0])||void 0===l||null===(t=l.details)||void 0===t?void 0:t.allowableOrgTemplates.filter((l=>{var t;return l.org_allowed_template===(null===e||void 0===e||null===(t=e.details)||void 0===t?void 0:t.ALLOWABLE_ORG_TEMPLATES)})))||[]).length&&c.push(e)}));else{var a,d;const e=null===l||void 0===l||null===(a=l.map((e=>{var l;return null===(l=e.details)||void 0===l?void 0:l.allowableOrgTemplates})))||void 0===a?void 0:a.flat(),t=null===e||void 0===e||null===(d=e.filter((e=>{var l;return"yes"===(null===(l=e.exclusive_use)||void 0===l?void 0:l.toLowerCase())})))||void 0===d?void 0:d.map((e=>e.org_allowed_template));let i=t.filter(((e,l)=>t.indexOf(e)===l));c=null===v||void 0===v?void 0:v.filter((e=>{var l;return!(null!==i&&void 0!==i&&i.includes(null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.ALLOWABLE_ORG_TEMPLATES))}))}var s;c.length&&(n=null===(s=c)||void 0===s?void 0:s.map((e=>{var l;return null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.ALLOWABLE_ORG_TEMPLATES}))),o=n;break;case"buplantmapping":const p=e("buplantmapping");o=(null===p||void 0===p?void 0:p.filter((e=>{var l,i;return(null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.PO_ORG)===(null===t||void 0===t||null===(i=t.mcoPropeties)||void 0===i?void 0:i.plantName)})))||[]}return o}("partTypeAndORGAllowed_TemplateMappings",v)}else{var h,x,f,y,g;if(null!==o&&void 0!==o&&o.getHighestSeqCurrentOrActiveMR&&null!==(h=Object.keys(null===o||void 0===o?void 0:o.getHighestSeqCurrentOrActiveMR))&&void 0!==h&&h.length){const e=a(null===o||void 0===o?void 0:o.getHighestSeqCurrentOrActiveMR,r)||{};u=n(null===e||void 0===e?void 0:e.template,"mvoTemplateCompatibility",r),c.push("story 4")}const i=e("ORGAllowedTemplateMappings"),p=(null===i||void 0===i||null===(x=i.filter((e=>{var l,i,o;return"Y"===(null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.Plants[null===t||void 0===t||null===(i=t.mcoPropeties)||void 0===i?void 0:i.plantName])&&u.includes(null===e||void 0===e||null===(o=e.details)||void 0===o?void 0:o.ALLOWABLE_ORG_TEMPLATES)})))||void 0===x?void 0:x.map((e=>{var l;return null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.ALLOWABLE_ORG_TEMPLATES})))||[],m=e("buplantmapping"),C=s(m);C&&C.has(null===t||void 0===t||null===(f=t.mcoPropeties)||void 0===f?void 0:f.plantName)?null!==o&&void 0!==o&&o.isFirstSequence&&Object.keys(null===o||void 0===o?void 0:o.isFirstSequence).includes(null===r||void 0===r?void 0:r.name)&&null!==o&&void 0!==o&&o.isFirstSequence[null===r||void 0===r?void 0:r.name]&&(u=p):u=p,null!==p&&void 0!==p&&p.length&&c.push("story 5");const T=e("parttypetotemplate"),S=T.filter((e=>e.details.ENGG_ITEM_TYPE===v))||[];if(null!==S&&void 0!==S&&S.length){var b,w,j;let e=(null===(b=S[0])||void 0===b||null===(w=b.details)||void 0===w||null===(j=w.allowableOrgTemplates)||void 0===j?void 0:j.filter((e=>u.includes(null===e||void 0===e?void 0:e.org_allowed_template))))||[];null!==e&&void 0!==e&&e.length&&(u=null===e||void 0===e?void 0:e.map((e=>null===e||void 0===e?void 0:e.org_allowed_template)),c.push("story 6"))}else{var P,O,E;const e=null===T||void 0===T||null===(P=T.map((e=>{var l;return null===(l=e.details)||void 0===l?void 0:l.allowableOrgTemplates})))||void 0===P?void 0:P.flat(),l=(null===e||void 0===e||null===(O=e.filter((e=>{var l;return"yes"===(null===(l=e.exclusive_use)||void 0===l?void 0:l.toLowerCase())})))||void 0===O?void 0:O.map((e=>e.org_allowed_template)))||[];u=null===(E=u)||void 0===E?void 0:E.filter((e=>!(null!==l&&void 0!==l&&l.includes(e))))}const R=function(){var e,l;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=(null===t||void 0===t||null===(e=t.find((e=>{var l;return"buplantmapping"===e.MappingType&&e.BUID===i&&"RDO OU ORG SET"===(null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.Entity.toUpperCase())})))||void 0===e||null===(l=e.details)||void 0===l?void 0:l.PLANT)||{},a=[];if(n&&n[o]&&"yes"===n[o].toLowerCase()){var s;const e=null===(s=t.find((e=>{var l;return"buplantmapping"===e.MappingType&&e.BUID===i&&"PLANTGROUP"===(null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.Entity.toUpperCase())})))||void 0===s?void 0:s.details.PLANT;d(e).forEach(((e,l)=>{const t=null===e||void 0===e?void 0:e.filter((e=>n&&n[e]&&"yes"===n[e].toLowerCase()));if(null!==t&&void 0!==t&&t.includes(o))return a=t,a}))}return a}(l("buplantmapping",r.organization),r.organization,null===t||void 0===t||null===(y=t.mcoPropeties)||void 0===y?void 0:y.plantName);let k=[];R.forEach((e=>{var l;if(e!==(null===t||void 0===t||null===(l=t.mcoPropeties)||void 0===l?void 0:l.plantName)){let l=((e,l)=>{var t;const i=null===o||void 0===o?void 0:o.getHighestSeqCurrentPendingOrActiveMR;if(i&&null!==(t=Object.keys(i))&&void 0!==t&&t.length&&Object.keys(i).includes(l.name))return i[l.name].filter((e=>e.partName===(null===l||void 0===l?void 0:l.name))).find((t=>t.partAndPlant===`${l.name}_${e}`));return{}})(e,r);if(l){let e=n(l.template,"setcompatibletemplates",r);null!==e&&void 0!==e&&e.length&&k.push(e)}}}));const D=(null===(g=u)||void 0===g?void 0:g.filter((e=>k.flat().includes(e))))||[];u=k.length?D:u,c.push("story 8")}let C=[];return u.length&&u.forEach((e=>{const l=i.find((l=>(null===l||void 0===l?void 0:l.templateName)===e));l&&C.push(l)})),C.sort(((e,l)=>e.templateName.localeCompare(l.templateName))),console.log(c,"=======dropdown option appliedChecks",null===r||void 0===r?void 0:r.name),C=C.sort(((e,l)=>e.templateName.localeCompare(l.templateName))),C}};var $e=t(69596),Ve=t(10778);const _e=(0,o.ZP)(D.Z)((()=>({whiteSpace:"pre","& thead":{"& tr":{"& th":{paddingLeft:0,paddingRight:0}}},"& tbody":{"& tr":{"& td":{paddingLeft:0,textTransform:"capitalize"}}}}))),Ue=(0,o.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),qe=e=>{const l=new g.h,{importBulkUpdateFile:t,setImportBulkUpdateFile:o,savePartAndOracleTempInRedux:a}=e,[d,r]=(0,i.useState)(!1),[u,x]=(0,i.useState)(!1),[y,b]=(0,i.useState)(!1),[j,P]=(0,i.useState)(!1),[O,E]=(0,i.useState)(null),[T,S]=(0,i.useState)(null),R=localStorage.getItem("instance"),[k,D]=(0,i.useState)(!1),[I,N]=(0,i.useState)(null);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)(v.Z,{open:t,PaperProps:{style:{backgroundColor:"#fff",boxShadow:"none"}},style:{zIndex:999},children:[(0,A.jsx)(c.Z,{style:{cursor:"move"},id:"draggable-dialog-title",children:"Bulk Upload Oracle Template"}),(0,A.jsx)(p.Z,{children:(0,A.jsx)(m.Z,{children:(0,A.jsx)(n.Z,{width:"100%",overflow:"auto",children:(0,A.jsx)(_e,{children:(0,A.jsxs)(Z.Z,{children:[(0,A.jsxs)(M.Z,{children:[(0,A.jsx)(C.Z,{align:"left",children:"Upload File (Excel File)"}),(0,A.jsxs)(C.Z,{align:"left",children:[(0,A.jsxs)("div",{style:{paddingTop:"10px"},children:[(0,A.jsxs)(s.Z,{component:"label",variant:"contained",startIcon:(0,A.jsx)($e.Z,{}),children:["Upload file",(0,A.jsx)(Ue,{type:"file",name:"file",accept:".xls, .xlsx",onChange:e=>{console.log("file selected");const l=e.target.files[0];if(l){const t=l.name.split(".").pop();"xlsx"===t||"xls"===t?(E(e.target.files[0]),S(e.target.files[0].name),x(!1)):(x(!0),S(null),E(null))}else x(!0),S(null),E(null)}})]}),u&&(0,A.jsx)("p",{children:"Please Select xlsx file to Upload "})]}),T&&(0,A.jsx)("p",{children:T})]})]}),(0,A.jsx)(M.Z,{children:(0,A.jsxs)(C.Z,{colSpan:2,children:[(0,A.jsxs)("div",{style:{paddingTop:"10px"},children:[(0,A.jsx)("a",{onClick:()=>{l.downloadSampleFile("partAndOracleTemp/sample-partAndOracleTemp.xlsx")},download:"Example-XLSX-document",rel:"noreferrer",style:{color:"blue",cursor:"pointer"},children:"Click Here"})," to download the sample Excel template for the Oracle Template Update."]}),(0,A.jsxs)("div",{style:{paddingTop:"10px"},children:[(0,A.jsx)("b",{children:"Note:"})," Upload file must contain two columns with header labels in following order."]}),(0,A.jsxs)("div",{style:{paddingTop:"10px"},children:["1. Part Name",(0,A.jsx)("br",{}),"2. Oracle Template(Case sensitive)",(0,A.jsx)("br",{})]})]})})]})})})})}),(0,A.jsxs)(h.Z,{children:[(0,A.jsx)(s.Z,{onClick:()=>{let e=!1;if((null===O||O.length<1)&&(x(!0),e=!0),!e&&null!==O){let e={file:O,data:{Instance:R}};console.log(e,"postData"),r(!0),l.bulkUploadPartAndTemplate(e).then((async e=>{if(P(!0),E(null),S(null),o(!1),"success"===e.status){var l;b(e);const t=await a(null===e||void 0===e?void 0:e.data);if(null!==(l=Object.keys(t))&&void 0!==l&&l.length){const l=((e,l)=>{var t,i,o,n,a;return(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{style:{fontWeight:"bold"},children:[null===e||void 0===e||null===(t=e.success)||void 0===t?void 0:t.length," of ",null===l||void 0===l?void 0:l.length," MR assignments successfully updated. ",(null===e||void 0===e||null===(i=e.error)||void 0===i?void 0:i.length)+(null===e||void 0===e||null===(o=e.warning)||void 0===o?void 0:o.length)," failed."]}),null===e||void 0===e||null===(n=e.error)||void 0===n?void 0:n.map((e=>(0,A.jsx)("div",{children:(0,A.jsx)("b",{style:{color:"red"},children:e})},f().generate()))),null===e||void 0===e||null===(a=e.warning)||void 0===a?void 0:a.map((e=>(0,A.jsx)("div",{children:(0,A.jsx)("b",{style:{color:"#ebc034"},children:e})},f().generate())))]})})(t,null===e||void 0===e?void 0:e.data);D(!0),N({severity:"info",desc:l})}}else{var t;if(null!==e&&void 0!==e&&null!==(t=e.msg)&&void 0!==t&&t.length){var i;const l=(null===e||void 0===e||null===(i=e.msg)||void 0===i?void 0:i.map((e=>(0,A.jsx)("li",{children:e},f().generate()))))||[];D(!0),N({severity:"failed"===(null===e||void 0===e?void 0:e.status)?"error":null===e||void 0===e?void 0:e.status,desc:l})}}r(!1)}))}},children:"Done"}),(0,A.jsx)(s.Z,{autoFocus:!0,onClick:()=>{E(null),o(!1)},children:"Cancel"})]})]}),I?(0,A.jsx)(Ve.Z,{openAlert:k,openDesc:I,setOpenAlert:D}):(0,A.jsx)(A.Fragment,{}),d?(0,A.jsx)("div",{style:{textAlign:"center"},children:(0,A.jsx)(w.Z,{show:d})}):(0,A.jsx)(A.Fragment,{})]})};t(31185);const He="Promote >>";function Ge(e){const{selectedRoute:l}=e,[t,o]=(0,i.useState)("Create"),[n,a]=(0,i.useState)(["Create"]),[s,r]=(0,i.useState)(!1),[u,v]=(0,i.useState)(null),[c,p]=(0,i.useState)(!1);let m="SaaS"===localStorage.getItem("instance")?["Create","Review","Release"]:["Create","Release","Implemented"];const h=new g.h;(0,i.useEffect)((()=>{const e=localStorage.getItem(`saasLifecycleStep_${null===l||void 0===l?void 0:l.id}`);if(e&&m.includes(e)){o(e);const l=m.indexOf(e);a(m.slice(0,l+1))}}),[null===l||void 0===l?void 0:l.id]);const x=async()=>{if(l&&l.id){p(!0);try{m.indexOf(t);if("Create"===t){const e=await h.routeStart(l.id);if(console.log("routeStartResponse",e),"Started"!==(null===e||void 0===e?void 0:e.routeStatus))throw new Error("Route not started properly")}const e=await h.getTaskList(l.id);let i=null;if(Array.isArray(e)){const l=e.find((e=>{var l;return"complete"!==(null===(l=e.current)||void 0===l?void 0:l.toLowerCase())}));i=null===l||void 0===l?void 0:l.id,i||1!==e.length||(i=e[0].id)}else"string"===typeof e&&(i=e);if(i){const e=await h.taskApproval(i);if(null!==e&&void 0!==e&&e.success){const e=m.indexOf(t),i=m[e+1];i&&(a((e=>[...new Set([...e,i])])),o(i),localStorage.setItem(`saasLifecycleStep_${null===l||void 0===l?void 0:l.id}`,i)),r(!0),v({severity:"success",desc:" Task successfully approved!"})}}}catch(s){var e,i,n,d;r(!0),v({severity:"error",desc:(null===s||void 0===s||null===(e=s.response)||void 0===e||null===(i=e.data)||void 0===i||null===(n=i.details)||void 0===n||null===(d=n.Response)||void 0===d?void 0:d.ErrorMessage)||"Approval failed"})}finally{p(!1)}}};return(0,A.jsx)(d.ZP,{item:!0,md:12,sm:12,xs:12,className:"font-medium",children:(0,A.jsxs)("div",{style:{margin:"auto auto 25px auto",textAlign:"center",width:"75%",position:"relative"},children:[u&&(0,A.jsx)(Ve.Z,{openAlert:s,openDesc:u,setOpenAlert:r}),c&&(0,A.jsx)("div",{style:{textAlign:"center"},children:(0,A.jsx)(w.Z,{show:c})}),(0,A.jsx)(oe.Z,{sx:{width:"100%"},spacing:4,children:(0,A.jsx)(ne.Z,{alternativeLabel:!0,activeStep:m.indexOf(t),children:m.map(((e,l)=>(0,A.jsxs)(ae.Z,{children:[(0,A.jsxs)("div",{style:{width:"auto",minWidth:"110px",display:"inline-table",padding:"10px",color:t===e?"#ffffff":"#5c5c5c",background:t===e?"#42a2da":"#e6e7e8",zIndex:"1",position:"relative",top:"-10px",borderRadius:"-10px",boxShadow:"0px 2px 2px 0px rgba(0, 0, 0, 0.3)"},"data-state":e,children:[0!==l&&(0,A.jsx)("span",{style:{width:"0",height:"0",borderStyle:"solid",borderTop:"7px solid transparent",borderBottom:"7px solid transparent",borderLeft:"10px solid #bdbdbd",position:"absolute",left:"-10px",top:"15.5px"}}),e]}),n.includes(e)&&t===e&&"Release"!==e&&(0,A.jsx)("div",{children:(0,A.jsx)(de.Z,{component:"button",variant:"body2",underline:"none",title:He,onClick:x,children:He})})]},e)))})})]})})}const We=(0,o.ZP)("div")((e=>{let{theme:l}=e;return{margin:"30px",[l.breakpoints.down("sm")]:{margin:"16px"},"& .breadcrumb":{marginBottom:"30px",[l.breakpoints.down("sm")]:{marginBottom:"16px"}}}}));function ze(e){return(0,A.jsx)("div",{role:"tabpanel",hidden:(null===e||void 0===e?void 0:e.value)!==(null===e||void 0===e?void 0:e.index),id:`simple-tabpanel-${e.index}`,"aria-labelledby":`simple-tab-${null===e||void 0===e?void 0:e.index}`,...e.other,children:e.value===e.index&&(0,A.jsx)(n.Z,{sx:{p:3},children:(0,A.jsx)(a.Z,{children:e.children})})})}function Ke(e){return{id:`simple-tab-${e}`,"aria-controls":`simple-tabpanel-${e}`}}const Ye=()=>{var e,l,t,o;const a=Be(),x=(0,j.I0)(),{isPageHavingIssue:P,responseData:C,templates:T,templateMappingsInfo:S,lifeCycleData:R,systemSetingsDetail:k,mrDetails:D,RSMEList:I,RMEList:M,isPropertyFormEdited:Z,eachTemplateOptions:N,materialData:L,updatedRoutes:F}=(0,j.v9)((e=>({cc:e.mcoDetails.isPageHavingIssue,responseData:e.mcoDetails.responseData,templates:e.mcoDetails.templates,templateMappingsInfo:e.mcoDetails.templateMappingsInfo,lifeCycleData:e.mcoDetails.lifeCycleData,systemSetingsDetail:e.mcoDetails.systemSetingsDetail,mrDetails:e.mcoDetails.mrDetails,RSMEList:e.mcoDetails.RSMEList,RMEList:e.mcoDetails.RMEList,isPropertyFormEdited:e.mcoDetails.isPropertyFormEdited,eachTemplateOptions:e.mcoDetails.eachTemplateOptions,materialData:e.mcoDetails.materialData,updatedRoutes:e.mcoDetails.updatedRoutes})),j.wU),[B,$]=(0,i.useState)(0),[V,_]=(0,i.useState)(null),[U,q]=(0,i.useState)(!0),[H,G]=(0,i.useState)([]),[W,K]=(0,i.useState)(!1),[Y,X]=(0,i.useState)(!1),[J,Q]=(0,i.useState)("Start"),[ee,le]=(0,i.useState)(null),[te,oe]=(0,i.useState)(!1),[ne,ae]=(0,i.useState)(null),[de,se]=(0,i.useState)(!1),[re,ue]=(0,i.useState)(localStorage.getItem("plantType")||"");(0,i.useEffect)((()=>()=>localStorage.removeItem("plantType")),[]);const ce=localStorage.getItem("selectedRouteId"),pe=(0,i.useMemo)((()=>F.find((e=>e.id===ce))),[F,ce]),me=new g.h,he=(0,b.UO)(),xe=localStorage.getItem("instance"),fe=async(e,l)=>{try{let t=[];await(0,z.X8)(e,l).then((async()=>{var i;let o=[{id:null===e||void 0===e||null===(i=e.mcoPropeties)||void 0===i?void 0:i.id,instance:xe}],n=e;await me.getattributesbyid(o).then((async e=>{let i=!1,o={};if(null!==e&&void 0!==e&&e.data[0]){o=null===e||void 0===e?void 0:e.data[0],x((0,O.$V)({currentMcoDetails:o}));const l=await(async(e,l,t,i)=>{try{var o,n,a;return e.mcoaffectedItem=null===e||void 0===e?void 0:e.mcoaffectedItem.map((e=>{var t,o,n,a,d,s,r,u,v;const c={...e},p=(null===(t=l.data[0].mcoaffectedItem)||void 0===t?void 0:t.find((l=>(null===e||void 0===e?void 0:e.id)===l.id)))||{},m=null!==(o=null===p||void 0===p?void 0:p.materialType)&&void 0!==o?o:null;c.materialType=m;const h="yes"===(null===(n=c.exportToERP)||void 0===n?void 0:n.toLowerCase());let x=null===p||void 0===p?void 0:p.exportToERP;return"string"===typeof(null===p||void 0===p?void 0:p.exportToERP)&&"yes"===(null===p||void 0===p||null===(a=p.exportToERP)||void 0===a?void 0:a.toLowerCase())&&(x=!0),"string"===typeof(null===p||void 0===p?void 0:p.exportToERP)&&"no"===(null===p||void 0===p||null===(d=p.exportToERP)||void 0===d?void 0:d.toLowerCase())&&(x=!1),c.makeOrBuy=null!==p&&void 0!==p&&p.makeOrBuy?null===p||void 0===p||null===(s=p.makeOrBuy)||void 0===s?void 0:s.toLowerCase():null===c||void 0===c||null===(r=c.makeOrBuy)||void 0===r?void 0:r.toLowerCase(),c.exportToERP=null!==p&&void 0!==p&&p.exportToERP?x:h,c.itemStatus=null!==p&&void 0!==p&&p.itemStatus?null===p||void 0===p||null===(u=p.itemStatus)||void 0===u?void 0:u.toLowerCase():null===c||void 0===c||null===(v=c.ErpStatus)||void 0===v?void 0:v.toLowerCase(),c.isTemplateValueChange=!1,c.isMakeOrBuyValueChange=!1,c.isExportToERPValueChange=!1,c.isItemStatusValueChange=!1,m&&(i=!0),c})),null!==t&&void 0!==t&&null!==(o=t.mcoProperties)&&void 0!==o&&o.hasOwnProperty("ECOExportToERP")&&""!==(null===t||void 0===t||null===(n=t.mcoProperties)||void 0===n?void 0:n.ECOExportToERP)?e.mcoPropeties.ECOExportToERP=null===t||void 0===t||null===(a=t.mcoProperties)||void 0===a?void 0:a.ECOExportToERP:e.mcoPropeties.ECOExportToERP="yes",await x((0,O.qH)({mcoPropeties:null===e||void 0===e?void 0:e.mcoPropeties,mcoaffectedItem:null===e||void 0===e?void 0:e.mcoaffectedItem})),i}catch(d){throw(0,z.BS)(d,"findAndSaveExistingMco"),d}})(n,e,o,i);"boolean"===typeof l&&(i=l)}else await(async(e,l)=>{try{var t,i,o;return e.mcoaffectedItem=null===e||void 0===e?void 0:e.mcoaffectedItem.map(((e,l)=>{var t,i,o,n,a,d;const s={...e};let r=null===s||void 0===s?void 0:s.exportToERP;return"string"===typeof(null===s||void 0===s?void 0:s.exportToERP)&&"yes"===(null===s||void 0===s||null===(t=s.exportToERP)||void 0===t?void 0:t.toLowerCase())&&(r=!0),"string"===typeof(null===s||void 0===s?void 0:s.exportToERP)&&"no"===(null===s||void 0===s||null===(i=s.exportToERP)||void 0===i?void 0:i.toLowerCase())&&(r=!1),s.makeOrBuy=null!==(o=null===s||void 0===s||null===(n=s.makeOrBuy)||void 0===n?void 0:n.toLowerCase())&&void 0!==o?o:"buy",s.exportToERP=r,s.itemStatus=null!==(a=null===s||void 0===s||null===(d=s.ErpStatus)||void 0===d?void 0:d.toLowerCase())&&void 0!==a?a:"active",s.isTemplateValueChange=!1,s.isMakeOrBuyValueChange=!1,s.isExportToERPValueChange=!1,s.isItemStatusValueChange=!1,s})),l&&null!==(t=Object.keys(l))&&void 0!==t&&t.length&&null!==l&&void 0!==l&&null!==(i=l.mcoProperties)&&void 0!==i&&i.hasOwnProperty("ECOExportToERP")?e.mcoPropeties.ECOExportToERP=null===l||void 0===l||null===(o=l.mcoProperties)||void 0===o?void 0:o.ECOExportToERP:e.mcoPropeties.ECOExportToERP="yes",await x((0,O.qH)({mcoPropeties:e.mcoPropeties,mcoaffectedItem:e.mcoaffectedItem})),await x((0,O.$V)({currentMcoDetails:e})),e}catch(n){throw(0,z.BS)(n,"findAndSaveInitialMco"),n}})(n);await(async(e,l,t,i,o)=>{try{return t.length&&await me.getattributesbyid(t).then((async n=>{await ye(n,t,e,l,i,o)})).catch((l=>{be(e,o)})),t}catch(n){throw(0,z.BS)(n,"findAndSaveMasterMco"),n}})(n,o,l,i,t)})),await Se(n)}))}catch(t){return t}},ye=async(e,l,t,i,o,n)=>{var a;const d=(null===e||void 0===e?void 0:e.data[0])||{},s=we(l[0],null===t||void 0===t?void 0:t.mcoPropeties);d.plantName=null===t||void 0===t||null===(a=t.mcoPropeties)||void 0===a?void 0:a.plantName,d.master=s?"Y":"N",_(d),await x((0,O.$V)({masterData:d})),je(i,t)&&Q("Item");let r=(null===t||void 0===t?void 0:t.mcoaffectedItem)||[];var u;o||(r=Pe(null===t||void 0===t?void 0:t.mcoaffectedItem,d.mcoaffectedItem),null!==d&&void 0!==d&&null!==(u=d.mcoaffectedItem)&&void 0!==u&&u.length||await Ce(t,n));const v=(0,z.nQ)(t,d);await x((0,O.qH)({mcoProperties:v,mcoaffectedItem:r,masterData:d,isMaster:s?"Y":"N"}))},be=(e,l)=>{_({}),x((0,O.$V)({masterData:{}})),Ce(e,l)},we=(e,l)=>(null===e||void 0===e?void 0:e.id)===(null===l||void 0===l?void 0:l.id),je=(e,l)=>{var t;return(null===e||void 0===e?void 0:e.clientReleaseDate)&&""!==(null===e||void 0===e?void 0:e.clientReleaseDate)&&["Review"].includes(null===l||void 0===l||null===(t=l.mcoProperties)||void 0===t?void 0:t.mcostate)},Pe=(e,l)=>e.map((e=>{const t=(null===l||void 0===l?void 0:l.find((l=>(null===e||void 0===e?void 0:e.id)===l.id)))||{};return e.materialType=t.materialType||null,e})),Ce=async(e,l)=>{e.mcoaffectedItem.forEach((async(t,i)=>{var o,n,a;let d=null===l||void 0===l?void 0:l.filter(((e,l)=>{var i,o;return(null===t||void 0===t?void 0:t.materialType)&&e.templateName===(null===t||void 0===t||null===(i=t.materialType)||void 0===i?void 0:i.name)||e.desc===(null===t||void 0===t||null===(o=t.attributeGroupData)||void 0===o?void 0:o.ERPItemTypeTemplate)}));if(d=null!==(o=d)&&void 0!==o&&o.length?d[0]:{},Object.keys(d).length&&(null===(n=d)||void 0===n?void 0:n.desc)===(null===t||void 0===t||null===(a=t.attributeGroupData)||void 0===a?void 0:a.ERPItemTypeTemplate)){var s;let t=e.mcoaffectedItem;t[i].materialType=Object.keys(d).length?{name:null===(s=d)||void 0===s?void 0:s.templateName}:null,await De(t,i,l,e),await x((0,O.$V)({isMaterialFormEdited:!0}))}}))},Se=async e=>{const l=[];e.mcoaffectedItem.forEach((t=>{l.push(e.mcoPropeties.name+"_"+t.name)})),await me.getERPStatus(l).then((async e=>{if(null!==e&&void 0!==e&&e.data){const l=null===e||void 0===e?void 0:e.data.map((e=>{var l,t;return{Item_Name:null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.Item_Name,status:null===e||void 0===e||null===(t=e.details)||void 0===t?void 0:t.status}}));await x((0,O.qH)({itemERPStatus:[...l]}))}})).catch((e=>(q(!1),e)))},Re=async(e,l,t,i,o)=>{const n=null===o||void 0===o?void 0:o.findIndex((l=>(null===e||void 0===e?void 0:e.id)===(null===l||void 0===l?void 0:l.id)));-1!==n&&await x((0,O.$V)({selectedRowIndex:n}));((e,l,t,i)=>{let o=[];null===l||void 0===l||l.forEach((l=>{var n;(null===e||void 0===e||null===(n=e.materialType)||void 0===n?void 0:n.name)===l.templateName&&t.forEach((t=>{var n;if((null===e||void 0===e||null===(n=e.materialType)||void 0===n?void 0:n.name)===t.templateName){var a;const n=(null===t||void 0===t?void 0:t.attributes)||[],s=(null===l||void 0===l?void 0:l.attributes)||[];var d;if(n&&s&&(o=n,o=(null===e||void 0===e||null===(d=e.relatedMCOs[0])||void 0===d?void 0:d.id)===(null===i||void 0===i?void 0:i.id)?n:n.concat(s)),null!==(a=o)&&void 0!==a&&a.length){let e=[...o].filter(((e,l,t)=>l===(null===t||void 0===t?void 0:t.findIndex((l=>l.name===e.name)))));o=e}x((0,O.$V)({selectedRowFormdata:o}))}}))}))})(e,l,T,i);"form"===t&&await x((0,O.$V)({selectedRowData:e}))},ke=async(e,l,t,i)=>{var o,n;const a=i.mcoPropeties,d=null===a||void 0===a?void 0:a.plantName,s=null===e||void 0===e?void 0:e.organization,r=(0,Fe.m4)(S,s,d);if((null===r||void 0===r||!r.includes(d))&&(!Object.keys(e).length||null===e||void 0===e||!e.materialType||0===e))return oe(!0),void ae({severity:"info",desc:"Please select Material Type"});const u=await(0,z.uX)();var v;if(null!==i&&void 0!==i&&null!==(o=i.mcoPropeties)&&void 0!==o&&null!==(n=o.organizationId)&&void 0!==n&&n.includes("SAP")&&(V&&0===(null===(v=Object.keys(V))||void 0===v?void 0:v.length))){if(((null===u||void 0===u?void 0:u.filter((e=>{var l,t;return(null===e||void 0===e||null===(l=e.relatedMCOs[0])||void 0===l?void 0:l.id)!==(null===i||void 0===i||null===(t=i.mcoPropeties)||void 0===t?void 0:t.id)})))||[]).length)return oe(!0),void ae({severity:"info",desc:"Please check master MCO attributes!"})}if(null!==e&&void 0!==e&&e.materialType)await Re(e,l,t,null===i||void 0===i?void 0:i.mcoProperties,u);else{const l=null===u||void 0===u?void 0:u.findIndex((l=>(null===e||void 0===e?void 0:e.id)===(null===l||void 0===l?void 0:l.id))),t=[...u];t[l].materialType=null,await x((0,O.qH)((e=>({...e,...t}))))}await x((0,O.$V)({showMaterialForm:!0}))},De=async(e,l,t,i)=>{let o=e.filter(((e,t)=>t===l));o=o.length?o[0]:null,await x((0,O.qH)({mcoaffectedItem:e})),await x((0,O.$V)({isMaterialFormEdited:!0})),ke(o,t,"auto",i)},Ie=async e=>{try{const l=await(0,z.uX)();await x((0,O.qH)({mcoaffectedItem:l}));const t=null===C||void 0===C?void 0:C.mcoPropeties,i=null===t||void 0===t?void 0:t.plantName,o=`${null===t||void 0===t?void 0:t.name}_${i}`;"form"===e&&q(!0);const n=await me.getattributesbyid([{id:null===t||void 0===t?void 0:t.id,instance:xe}]),{status:a,message:d}=n;if("failed"===a)return oe(!0),ae({severity:"error",desc:d}),!1;const s=l?JSON.parse(JSON.stringify(l)):[],r=(null===s||void 0===s?void 0:s.map((e=>(null===e||void 0===e||delete e.isTemplateValueChange,null===e||void 0===e||delete e.isMakeOrBuyValueChange,null===e||void 0===e||delete e.isExportToERPValueChange,null===e||void 0===e||delete e.isItemStatusValueChange,e))))||[],u=await ol(),v={id:null===t||void 0===t?void 0:t.id,producthub:`${o}`,uniquePartId:`${o}`,mcoProperties:t,mcoaffectedItem:r,source:null===C||void 0===C?void 0:C.source,target:null===C||void 0===C?void 0:C.target,partlistPayload:u};if(Object.keys(null===n||void 0===n?void 0:n.data).length&&null!==n&&void 0!==n&&n.data[0]){const t=await me.updatePartListAndAttributes(v);if("failed"===t.status)return oe(!0),void ae({severity:"error",desc:"Something went wrong while updating MR data to Enovia. Please update the templates again."});"object"===typeof t&&(t.data.mcoaffectedItem=l,await Ve(t,"updated",e),await x((0,O.$V)({bulkPartTemplates:[]})))}else{const l=await me.updatePartListAndAddAttributes(v);if("failed"===l.status)return oe(!0),void ae({severity:"error",desc:"Something went wrong while updating MR data to Enovia. Please update the templates again."});"object"===typeof l&&(await Ve(l,"added",e),await x((0,O.$V)({bulkPartTemplates:[]})))}return"form"===e&&setTimeout((()=>{q(!1)}),500),!0}catch(l){return!1}},$e=async function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var t;const i=await(0,z.uX)(),o=null===i||void 0===i?void 0:i.map((l=>{var t,i,o,n,a,d,s,r;return{partAndPlant:`${null===l||void 0===l?void 0:l.name}_${null===e||void 0===e||null===(t=e.mcoPropeties)||void 0===t?void 0:t.plantName}`,partName:`${null===l||void 0===l?void 0:l.name}`,plantName:`${null===e||void 0===e||null===(i=e.mcoPropeties)||void 0===i?void 0:i.plantName}`,revision:null===l||void 0===l?void 0:l.revision,mcoId:null===e||void 0===e||null===(o=e.mcoPropeties)||void 0===o?void 0:o.id,mcoName:null===e||void 0===e||null===(n=e.mcoPropeties)||void 0===n?void 0:n.name,ERPStatus:null===l||void 0===l||null===(a=l.itemStatus)||void 0===a?void 0:a.toLowerCase(),makeOrBuy:null===l||void 0===l||null===(d=l.makeOrBuy)||void 0===d?void 0:d.toLowerCase(),template:null===l||void 0===l||null===(s=l.materialType)||void 0===s?void 0:s.name,mcobusinessUnit:null===e||void 0===e||null===(r=e.mcoPropeties)||void 0===r?void 0:r.businessUnit,partId:null===l||void 0===l?void 0:l.id,instance:xe}})),n=await me.getMRRelatedDetailsbyid({mcoName:null===e||void 0===e||null===(t=e.mcoPropeties)||void 0===t?void 0:t.name});"load"===l?Object.keys((null===n||void 0===n?void 0:n.data)||{}).length||await me.addMRRelatedDetails(o):Object.keys((null===n||void 0===n?void 0:n.data)||{}).length&&null!==n&&void 0!==n&&n.data[0]?await me.updateMRRelatedDetails(o):await me.addMRRelatedDetails(o)}catch(i){if("load"===l)throw(0,z.BS)(i,"handleMRDetails"),i;return null===i||void 0===i?void 0:i.message}},Ve=async(e,l,t)=>{if("form"===t&&(oe(!0),ae({severity:"success",desc:`Attributes ${l} successfully!`})),await x((0,O.$V)({isMaterialFormEdited:!1})),null!==e&&void 0!==e&&e.data){var i,o;const l=(null===(i=C.mcoaffectedItem)||void 0===i?void 0:i.map(((l,t)=>{var i,o;return{...l,...null===e||void 0===e||null===(i=e.data)||void 0===i||null===(o=i.mcoaffectedItem)||void 0===o?void 0:o[t]}})))||[];await x((0,O.qH)({mcoPropeties:null===e||void 0===e||null===(o=e.data)||void 0===o?void 0:o.mcoProperties,mcoaffectedItem:l})),await $e(C),await(0,z.t6)(C)}},_e=async function(){var e;let l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form",t=Ue();if(!t&&"auto"!==l)return oe(!0),ae({severity:"error",desc:"Invalid Properties. Please check properties fields."}),t;const i=(0,z.XA)(C);await x((0,O.$V)({isPropertyFormEdited:!1})),"auto"!==l&&q(!0);let o=!1;return await me.updateMCOData(null===C||void 0===C||null===(e=C.mcoPropeties)||void 0===e?void 0:e.id,i).then((async e=>{var t;if("object"!==typeof e||!Object.keys(e).length||null!==(t=Object.keys(e))&&void 0!==t&&t.includes("code"))o=!0,oe(!0),ae({severity:"error",desc:"An unexpected error occurred."}),q(!1);else{var i,n,a,d;const t=(null===M||void 0===M?void 0:M.find((l=>l.key===(null===e||void 0===e?void 0:e.rme))))||null;e.rmeEmailAddress=t&&null!==(i=Object.keys(t))&&void 0!==i&&i.length?null===t||void 0===t?void 0:t.email:null;const r=(null===I||void 0===I?void 0:I.find((l=>l.key===(null===e||void 0===e?void 0:e.rsme))))||null;var s;if(e.rsmeEmailAddress=r&&null!==(n=Object.keys(r))&&void 0!==n&&n.length?null===r||void 0===r?void 0:r.email:null,e.ECOExportToERP="",null!==C&&void 0!==C&&null!==(a=C.mcoPropeties)&&void 0!==a&&a.ECOExportToERP)e.ECOExportToERP=null===C||void 0===C||null===(s=C.mcoPropeties)||void 0===s?void 0:s.ECOExportToERP;if(await x((0,O.qH)({mcoPropeties:e})),null!==(d=Object.keys(e))&&void 0!==d&&d.includes("errorMsg")&&null!==e&&void 0!==e&&e.errorMsg&&""!==(null===e||void 0===e?void 0:e.errorMsg)){if("auto"!==l)return oe(!0),ae({severity:"error",desc:null===e||void 0===e?void 0:e.errorMsg}),q(!1),!1;o=!0}"auto"!==l&&(oe(!0),ae({severity:"success",desc:"Properties updated successfully!"})),await(0,z.ak)(e,C,"savePropertiesOnly"),"auto"!==l&&q(!1)}})).catch((e=>{o=!0;let l=null;l="Network Error"===e.message?"Network error, please check your internet connection.":"ECONNABORTED"===e.code?"A timeout occurred.":e.response?`Server error: ${e.response.status} ${e.response.statusText}`:"An unexpected error occurred.",e.message.includes("net::ERR_NETWORK_CHANGED")&&(l="Network changed, please check your internet connection."),l&&(oe(!0),ae({severity:"error",desc:l}),q(!1))})),o},Ue=()=>{const e=["description","rme","rsme","startdate","ECOExportToERP"];for(const l in null===C||void 0===C?void 0:C.mcoPropeties)if(null!==C&&void 0!==C&&C.mcoPropeties.hasOwnProperty(l)&&e.includes(l)&&(null===C||void 0===C||!C.mcoPropeties[l]||"Invalid Date"===(null===C||void 0===C?void 0:C.mcoPropeties[l])||"Unassigned"===(null===C||void 0===C?void 0:C.mcoPropeties[l])))return!1;return!0},He=async function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;"SaaS"===xe&&("demote"===l&&"In Approval"===e?e="In Work":"In Work"===e&&(e="In Approval"));try{var t,i,o,n,a,d,s;l&&q(!0);let p={};"Release"!==e&&"Approved"!==e||(p=await(0,z.qe)(C));let m={};var r,u,v,c;if(m=await me.mcoStatusValidation([null===C||void 0===C||null===(t=C.mcoPropeties)||void 0===t?void 0:t.name]),"success"===(null===(i=m)||void 0===i?void 0:i.status)&&"failed"===(null===(o=m)||void 0===o||null===(n=o.data)||void 0===n||null===(a=n[null===C||void 0===C||null===(d=C.mcoPropeties)||void 0===d?void 0:d.name])||void 0===a?void 0:a.status))return oe(!0),ae({severity:"error",desc:null===(r=m)||void 0===r||null===(u=r.data)||void 0===u||null===(v=u[null===C||void 0===C||null===(c=C.mcoPropeties)||void 0===c?void 0:c.name])||void 0===v?void 0:v.message}),q(!1),!1;await me.changeStateByMcoId(null===C||void 0===C||null===(s=C.mcoPropeties)||void 0===s?void 0:s.id,e,p).then((async e=>{if(Object.keys(e).length){var l,t,i;if(e.ECOExportToERP="",null!==C&&void 0!==C&&null!==(l=C.mcoPropeties)&&void 0!==l&&l.ECOExportToERP)e.ECOExportToERP=null===C||void 0===C||null===(i=C.mcoPropeties)||void 0===i?void 0:i.ECOExportToERP;if(await x((0,O.qH)({mcoPropeties:e})),le(null===e||void 0===e?void 0:e.mcostate),await(0,z.ak)(e,C,"saveMcoState"),(null===C||void 0===C||null===(t=C.mcoPropeties)||void 0===t?void 0:t.mcostate)===(null===e||void 0===e?void 0:e.mcostate))return oe(!0),void ae({severity:"error",desc:null!==e&&void 0!==e&&e.errorMsg?null===e||void 0===e?void 0:e.errorMsg:"Status update failed. Please verify the details and try again."});["Implemented","Complete"].includes(null===e||void 0===e?void 0:e.mcostate)&&(oe(!0),ae({severity:"success",desc:"Successfully implemented!"}),le("Implemented")),["Create"].includes(null===e||void 0===e?void 0:e.mcostate)&&(oe(!0),ae({severity:"info",desc:"Demoted successfully!"})),["Review"].includes(null===e||void 0===e?void 0:e.mcostate)&&(oe(!0),ae({severity:"success",desc:"Promoted successfully!"}),le("Review"))}})),l&&q(!1)}catch(p){return q(!1),null===p||void 0===p?void 0:p.message}},Ye=async e=>{var l;let t=!1;return await me.validationByMcoId(null===e||void 0===e||null===(l=e.mcoPropeties)||void 0===l?void 0:l.id).then((async e=>{var l;if(null!==e&&void 0!==e&&e.pass)t=!0;else if(null!==e&&void 0!==e&&null!==(l=e.fail)&&void 0!==l&&l.length){var i;const l=[];null===e||void 0===e||null===(i=e.fail)||void 0===i||i.forEach((e=>{if(null!==e&&void 0!==e&&e.includes("Pass~~")||null!==e&&void 0!==e&&e.includes("Pass~"))return!0;if(null!==e&&void 0!==e&&e.includes("Fail~~")){const t=null===e||void 0===e?void 0:e.replace("Fail~~","");l.push(t)}else if(null!==e&&void 0!==e&&e.includes("Fail~")){const t=null===e||void 0===e?void 0:e.replace("Fail~","");l.push(t)}else l.push(e)}));const t=null===l||void 0===l?void 0:l.map((e=>(0,A.jsx)("li",{children:e},f().generate())));oe(!0),ae({severity:"error",desc:t})}})),t},Xe=async e=>{const l=await(0,z.uX)(),{valid:t,errDesc:i}=await(0,z.sx)("lifecycle",C,l,H);if(!t)return el(i),!1;let o=await Je();const{valid:n,errDesc:a}=o;if(!n)return ll(a),!1;if("Create"===e||"Prepare"===e||"In Work"===e){if(await tl())return q(!1),!1}else if(("Review"===e||"In Approval"===e)&&await il())return q(!1),!1;return!0},Je=async()=>{let e={valid:!0,errDesc:[]},l=!0;if(null!==k&&void 0!==k&&k.length){var t;let i={affectedItemsInfo:C};if(null!==(t=window)&&void 0!==t&&t.ExternalClass){const t=new window.ExternalClass(i);e=await t.dropdownValidation(),l=!1,e.hasOwnProperty("valid")}}var i,o;l&&(null!==C&&void 0!==C&&null!==(i=C.mcoPropeties)&&void 0!==i&&null!==(o=i.organizationId)&&void 0!==o&&o.includes("SAP")||(e=await(0,Fe.pJ)(C)));return e},Qe=async()=>!!await Ye(C)&&(await He("Implemented"),await He("Complete"),!0),el=e=>{let l=e;var t;if("object"!==typeof e||Array.isArray(e)||null===e)if(Array.isArray(e))l=null===e||void 0===e?void 0:e.map((e=>(0,A.jsx)("li",{children:e},f().generate())));else{if("string"!==typeof e)return;l=e}else Object.keys(e).length&&(l=null===(t=Object.keys(e))||void 0===t?void 0:t.map((l=>(0,A.jsx)("li",{children:e[l]},f().generate()))));oe(!0),ae({severity:"error",desc:l})},ll=e=>{const l=null===e||void 0===e?void 0:e.map((e=>(0,A.jsx)("li",{children:e},f().generate())));oe(!0),ae({severity:"error",desc:l})},tl=async()=>{if("onPrem"===xe){if(await Ye(C))return await He("Review"),!0}else await He(C.mcoPropeties.mcostate);return!1},il=async()=>{var e;if("onPrem"===xe&&!await Ye(C))return!1;const l=localStorage.getItem("instance"),t={mcolists:[null===C||void 0===C||null===(e=C.mcoPropeties)||void 0===e?void 0:e.name],instance:l};try{const e=await me.sendMCO(t);nl(e)}catch(i){return!1}return!0},ol=async()=>{const e=await(0,z.uX)();return null===e||void 0===e?void 0:e.map((e=>{var l,t,i,o,n,a,d,s,r;const u=null===e||void 0===e?void 0:e.organization,v=(null===S||void 0===S?void 0:S.filter((e=>{var l,t;return"orgallowedvalues"===e.MappingType&&(null===(l=e.BUID)||void 0===l?void 0:l.toLowerCase())===(null===u||void 0===u?void 0:u.toLowerCase())&&"y"===((null===e||void 0===e||null===(t=e.details)||void 0===t?void 0:t.Optional)||"").toLowerCase()})).map((e=>{var l;return null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.ALLOWABLE_ORG_TEMPLATES})))||[],c=(null===Le||void 0===Le||null===(l=Le.mmiMBOM)||void 0===l||null===(t=l.ComAssyOptionalNo)||void 0===t?void 0:t.includes(null===e||void 0===e||null===(i=e.materialType)||void 0===i?void 0:i.name))||!1,p=(null===D||void 0===D||null===(o=D.previousSeqMR[null===e||void 0===e?void 0:e.name])||void 0===o||null===(n=o[0])||void 0===n?void 0:n.makeOrBuy)||null;return{PartObjectId:null===e||void 0===e?void 0:e.id,MCOId:null===C||void 0===C||null===(a=C.mcoPropeties)||void 0===a?void 0:a.id,PartName:null===e||void 0===e?void 0:e.name,PartType:null===e||void 0===e?void 0:e.type,PlantName:null===C||void 0===C||null===(d=C.mcoPropeties)||void 0===d?void 0:d.plantName,isMakeOrBuyChanged:!!p&&p!==(null===e||void 0===e?void 0:e.makeOrBuy),newMakeOrBuyValue:null===e||void 0===e?void 0:e.makeOrBuy,template:(null===e||void 0===e||null===(s=e.materialType)||void 0===s?void 0:s.name)||"Unassigned",slOptionalYesValue:null===v||void 0===v?void 0:v.includes(null===e||void 0===e||null===(r=e.materialType)||void 0===r?void 0:r.name),slOptionalNoValues:c}}))},nl=e=>{"success"===(null===e||void 0===e?void 0:e.status)?(Q("Item"),oe(!0),ae({severity:"info",desc:null===e||void 0===e?void 0:e.message})):(oe(!0),ae({severity:"error",desc:null===e||void 0===e?void 0:e.message}))},al=async()=>{let e=null;try{var l,t,i,o,n;if(q(!0),await x((0,O.VM)()),"onPrem"===xe&&await(0,z.IT)(),e=await(async()=>{try{const d=await me.getMCOdetailById(he);if(d&&Object.keys(d).length){var e,l,t,i,o,n,a;le(null===d||void 0===d||null===(e=d.mcoPropeties)||void 0===e?void 0:e.mcostate);const s=null!==Le&&void 0!==Le&&null!==(l=Le.systemSettings)&&void 0!==l&&l[null===d||void 0===d||null===(t=d.source)||void 0===t?void 0:t.url]?null===Le||void 0===Le||null===(i=Le.systemSettings)||void 0===i?void 0:i[null===d||void 0===d||null===(o=d.source)||void 0===o?void 0:o.url]:null;let r={bu:null===d||void 0===d||null===(n=d.mcoPropeties)||void 0===n?void 0:n.businessUnit,instance:s,systemName:null===d||void 0===d||null===(a=d.source)||void 0===a?void 0:a.url};return localStorage.getItem("instance")||localStorage.setItem("instance",s),await x((0,E.M)(r)),{status:!0,data:d}}return x((0,O.$V)({isPageHavingIssue:!0})),{status:!1,data:"Something went wrong!"}}catch(d){return x((0,O.$V)({isPageHavingIssue:!0})),q(!1),{status:!1,data:d}}})(),null!==(l=e)&&void 0!==l&&l.status)await rl(!1,null===(t=e)||void 0===t?void 0:t.data),await(async e=>{try{var l,t,i,o;if(e.length)return!0;const d=(null===e||void 0===e?void 0:e.mcoaffectedItem)&&((null===e||void 0===e||null===(l=e.mcoaffectedItem)||void 0===l?void 0:l.map((e=>{var l,t;const i=!Object.keys((null===e||void 0===e||null===(l=e.materialType)||void 0===l?void 0:l.attributeMap)||{}).length;return{id:e.id,materialTypeError:!(null!==e&&void 0!==e&&null!==(t=e.materialType)&&void 0!==t&&t.name),attributeFormError:i}})))||[]);G(d);const s=[];var n,a;null!==e&&void 0!==e&&null!==(t=e.mcoPropeties)&&void 0!==t&&null!==(i=t.organizationId)&&void 0!==i&&i.includes("SAP")&&(null!==e&&void 0!==e&&e.mcoaffectedItem&&(null===e||void 0===e||e.mcoaffectedItem.forEach((e=>{var l;if(!s.length&&null!==e&&void 0!==e&&e.relatedMCOs&&Object.keys(null===e||void 0===e?void 0:e.relatedMCOs[0]).includes("id")&&null!==e&&void 0!==e&&null!==(l=e.relatedMCOs[0])&&void 0!==l&&l.id){var t;let l={id:null===e||void 0===e||null===(t=e.relatedMCOs[0])||void 0===t?void 0:t.id};s.push(l)}}))),s.length&&(e.isMaster=(null===(n=s[0])||void 0===n?void 0:n.id)===(null===e||void 0===e||null===(a=e.mcoPropeties)||void 0===a?void 0:a.id)?"Y":"N")),null!==e&&void 0!==e&&null!==(o=e.mcoPropeties)&&void 0!==o&&o.hasOwnProperty("ECOExportToERP")||(e.mcoPropeties.ECOExportToERP=""),await x((0,O.Ph)(e)),await x((0,O.$V)({currentMcoDetails:e})),await fe(e,s)}catch(d){throw(0,z.BS)(d,"collectMCOdetails"),d}})(null===(i=e)||void 0===i?void 0:i.data),await $e(null===(o=e)||void 0===o?void 0:o.data,"load"),await(0,z.t6)(null===(n=e)||void 0===n?void 0:n.data),await(0,z.WO)()}catch(a){await x((0,O.$V)({isPageHavingIssue:!0})),console.error("An error occurred:",a)}finally{setTimeout((async()=>{se(!0),q(!1)}),1e3)}},dl=async e=>{const l=await(async e=>{var l;let t={};return null===e||void 0===e||null===(l=e.mcoaffectedItem)||void 0===l||l.forEach((async e=>{let l=await a(e)||[];t[null===e||void 0===e?void 0:e.name]=l})),t})(C);e&&await x((0,O.$V)({eachTemplateOptions:l}))};(0,i.useEffect)((()=>{dl(de)}),[de]);const sl=async function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};q(!0);try{await rl(e,l)}catch(t){return{status:!1,data:t.message}}finally{q(!1)}},rl=async function(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(null!==he&&void 0!==he&&he.mco_id){var t;const i=[null===he||void 0===he?void 0:he.mco_id],o=await ul(i);if(null!==(t=Object.keys(o))&&void 0!==t&&t.length)if(vl(o),e){const e=await me.getMcoPropertyDetails(null===he||void 0===he?void 0:he.mco_id);if(e&&Object.keys(e).length){const t={...null===l||void 0===l?void 0:l.mcoPropeties,...e};await x((0,O.qH)({mcoPropeties:t})),le(null===e||void 0===e?void 0:e.mcostate);let i=[{id:null===e||void 0===e?void 0:e.id,instance:xe}];cl(o,e)?Q("Item"):Q("Stop"),await me.getattributesbyid(i).then((async e=>{let l={};var i,o;null!==e&&void 0!==e&&e.data[0]&&(l=null===e||void 0===e?void 0:e.data[0],await x((0,O.$V)({currentMcoDetails:l,affectedPartsData:null===(i=l)||void 0===i?void 0:i.mcoaffectedItem})),await x((0,O.qH)({mcoPropeties:t,mcoaffectedItem:null===(o=l)||void 0===o?void 0:o.mcoaffectedItem})),await(0,z.WO)())}))}}else cl(o,null===l||void 0===l?void 0:l.mcoPropeties)?Q("Item"):Q("Stop");await Se(l)}}catch(i){throw(0,z.BS)(i,"handleRefresh"),i}},ul=async e=>{try{const l=await me.getLifeCycleStatusByMCOName(e);return null===l||void 0===l?void 0:l.data}catch(l){throw x((0,O.$V)({isPageHavingIssue:!0})),(0,z.BS)(l),l}},vl=e=>{x((0,O.$V)({lifeCycleData:e}))},cl=(e,l)=>{var t,i,o,n;const a=null===he||void 0===he?void 0:he.mco_id,d=null===e||void 0===e||null===(t=e[a])||void 0===t?void 0:t.promoted,s=null===e||void 0===e||null===(i=e[a])||void 0===i?void 0:i.releaseStatus,r=null===l||void 0===l?void 0:l.mcostate.toLowerCase();return(null===(o=["inprogress","success"])||void 0===o?void 0:o.includes(d))&&"review"===r||(null===(n=["failed"])||void 0===n?void 0:n.includes(s))};(0,i.useEffect)((()=>{let e=null;return(async()=>{if(null!==k&&void 0!==k&&k.length){let t=null!==k&&void 0!==k&&k.length?k[0]:null;var l;if(t)"undefined"===typeof(null===(l=window)||void 0===l?void 0:l.ExternalClass)&&(e=document.createElement("script"),e.src=`${window.location.origin}/resources/js/${t.file1}.js`,e.onerror=(e=>()=>{console.error(`Failed to load script: ${e.src}`)})(e),fetch(e.src).then((e=>{if(!e.ok||!e.headers.get("content-type").includes("javascript"))throw new Error("Not a JavaScript file");return e.blob()})).then((()=>{document.body.appendChild(e)})).catch((l=>{console.error(`Failed to load script: ${e.src}`,l)})))}})(),()=>{if(null!==k&&void 0!==k&&k.length){(null!==k&&void 0!==k&&k.length?k[0]:null)&&e&&document.body.contains(e)&&document.body.removeChild(e)}}}),[k]),(0,i.useEffect)((()=>{al()}),[]);const[pl,ml]=(0,i.useState)(!1),hl=async()=>{const e=null===C||void 0===C?void 0:C.mcoPropeties,l=null===C||void 0===C?void 0:C.mcoaffectedItem;(0,z.oJ)(e,l).then((e=>{oe(!0),ae({severity:null===e||void 0===e?void 0:e.status,desc:null===e||void 0===e?void 0:e.msg})}))},xl=(0,i.useRef)(!0);return(0,i.useEffect)((()=>{xl.current?xl.current=!1:sl(!0,C)}),[W]),(0,A.jsxs)(We,{children:[P?(0,A.jsx)(Ee.Z,{}):(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(n.Z,{className:"breadcrumb",children:(0,A.jsxs)(d.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,A.jsx)(d.ZP,{item:!0,md:6,sm:12,xs:12,children:(0,A.jsx)(y.aG,{routeSegments:[{name:null!==C&&void 0!==C&&null!==(e=C.mcoPropeties)&&void 0!==e&&e.name?`${C.mcoPropeties.name} - MCO Details`:"MCO Details"}]})}),(0,A.jsx)(d.ZP,{item:!0,md:6,sm:12,xs:12,className:"textAlignRight",children:(0,A.jsx)(Ae,{responseData:C,setShowTrackerBox:K,setShowHistoryBox:X})})]})}),(0,A.jsxs)(y.sF,{children:[(0,A.jsxs)(d.ZP,{container:!0,spacing:3,alignItems:"center",className:"elementPostionRelative",children:[(0,A.jsx)(Ze,{handleRefreshButtonFunc:sl,responseData:C}),"SaaS"===xe?(0,A.jsx)(Ge,{selectedRoute:pe}):(0,A.jsx)(ve,{stepData:ee,lifeCycleStep:J,handleLifeCycle:async e=>Z?(oe(!0),void ae({severity:"error",desc:"There are unsaved changes in the properties. Kindly save your edits before proceeding."})):await(0,z.CR)()?(oe(!0),void ae({severity:"error",desc:"Saving changes is required or Reload to revert back to Prior Template values"})):void(async(e,l)=>{C.action=l,q(!0);const t=await(0,z.CR)();if(["Create","Release","Implemented   "].includes(e)){var i,o;let l=[{id:null===C||void 0===C||null===(i=C.mcoPropeties)||void 0===i?void 0:i.id,instance:xe}];if(new Date(null===C||void 0===C||null===(o=C.mcoPropeties)||void 0===o?void 0:o.startdate).getFullYear()>=2049)return oe(!0),ae({severity:"error",desc:"Please set MCO date, promotion cannot be processed with default date."}),void q(!1);const{status:s,message:r,data:u}=await me.getattributesbyid(l);if("failed"===s)return oe(!0),ae({severity:"error",desc:r}),q(!1),!1;const v=(null===u||void 0===u?void 0:u.find((e=>{var l;return(null===e||void 0===e?void 0:e.id)===(null===C||void 0===C||null===(l=C.mcoPropeties)||void 0===l?void 0:l.id)})))||{};if(Object.keys(u).length&&v[Object.keys(u).length]){var n,a,d;if((null===C||void 0===C||null===(n=C.mcoPropeties)||void 0===n?void 0:n.mcostate)!==(null===v||void 0===v||null===(a=v.mcoProperties)||void 0===a?void 0:a.mcostate))return oe(!0),ae({severity:"error",desc:`Promote Request was started already for ${null===v||void 0===v||null===(d=v.mcoProperties)||void 0===d?void 0:d.name}, use refresh to confirm completion or error details`}),q(!1),!1;Z||await x((0,O.qH)({mcoPropeties:null===v||void 0===v?void 0:v.mcoProperties,mcoaffectedItem:null===v||void 0===v?void 0:v.mcoaffectedItem})),t||await x((0,O.qH)({mcoPropeties:null===v||void 0===v?void 0:v.mcoProperties,mcoaffectedItem:null===v||void 0===v?void 0:v.mcoaffectedItem}))}if(Z){const e=await _e("auto");if(e)return q(!1),e}["Create","Prepare","In Work"].includes(e)&&t&&await Ie("auto"),await Xe(e)||q(!1)}else await Qe()||q(!1);q(!1)})(e),demoteState:He})]}),(0,A.jsxs)(n.Z,{sx:{width:"100%",position:"relative"},children:[[1].includes(B)?(0,A.jsx)(A.Fragment,{children:(0,A.jsx)(Te,{tapvalue:B,stepData:ee,bulkUploadPartandTemplate:()=>{ml(!0)},submitAffectedParts:()=>Ie("form"),exportMCOData:hl})}):(0,A.jsx)(A.Fragment,{}),[0].includes(B)?(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(s.Z,{variant:"contained",onClick:()=>hl(),className:"exportMcoDataBtn",children:"Export"}),(0,A.jsx)(s.Z,{variant:"contained",onClick:()=>{_e("form")},className:"saveMcoDataBtn",disabled:["Release","Implemented"].includes(ee)||!Z,children:"Save"})]}):(0,A.jsx)(A.Fragment,{}),(0,A.jsx)(n.Z,{sx:{borderBottom:1,borderColor:"divider"},children:(0,A.jsxs)(r.Z,{value:B,onChange:(e,l)=>{$(l)},"aria-label":"basic tabs example",children:[(0,A.jsx)(u.Z,{label:"Properties",...Ke(0)}),(0,A.jsx)(u.Z,{label:"Parts",...Ke(1)})]})}),(0,A.jsx)(ze,{value:B,index:0,children:(0,A.jsx)(Oe,{selectedRoute:pe,plantType:re,tapvalue:B,stepData:ee,submitPropertiesForm:_e})}),(0,A.jsx)(ze,{value:B,index:1,children:(0,A.jsx)(ie,{handleIconClick:ke})})]}),(0,A.jsx)(qe,{importBulkUpdateFile:pl,setImportBulkUpdateFile:ml,savePartAndOracleTempInRedux:async e=>{const l=e,t={success:[],error:[],warning:[]},i=await(0,z.uX)();let o=[];null===l||void 0===l||l.forEach((e=>{var l;const n=(null===i||void 0===i?void 0:i.find((l=>{var t;return Object.keys(e).includes("Part Name")&&(null===e||void 0===e||null===(t=e["Part Name"])||void 0===t?void 0:t.trim())===(null===l||void 0===l?void 0:l.name)})))||{};null!==(l=Object.keys(n))&&void 0!==l&&l.length?o.push(null===e||void 0===e?void 0:e["Part Name"]):t.error.push(`ERROR: Part ${null===e||void 0===e?void 0:e["Part Name"]} not found in MCO. Skipping`)}));const n=null===i||void 0===i?void 0:i.map(((e,i)=>{var n;let a={...e},d=(null===N||void 0===N?void 0:N[null===e||void 0===e?void 0:e.name])||[],s={};if(null===o||void 0===o||!o.includes(null===e||void 0===e?void 0:e.name))return e;if(null!==l&&void 0!==l&&l.length){var r;const i=(null===l||void 0===l?void 0:l.find((l=>{var t;return Object.keys(l).includes("Part Name")&&(null===(t=l["Part Name"])||void 0===t?void 0:t.trim())===(null===e||void 0===e?void 0:e.name)})))||{};if(s=(null===L||void 0===L?void 0:L.find((e=>{var l;return Object.keys(i).includes("Oracle Template")&&(null===(l=i["Oracle Template"])||void 0===l?void 0:l.trim())===e.templateName})))||{},null!==(r=Object.keys(s))&&void 0!==r&&r.length){var u,v,c,p,m;if(null===d||void 0===d?void 0:d.some((e=>{var l;return(null===e||void 0===e?void 0:e.templateName)===(null===(l=s)||void 0===l?void 0:l.templateName)})))if((null===e||void 0===e||null===(u=e.materialType)||void 0===u?void 0:u.name)===(null===(v=s)||void 0===v?void 0:v.templateName))t.warning.push(`WARNING: Same Oracle Template value already exists on MCO ${null===C||void 0===C||null===(c=C.mcoPropeties)||void 0===c?void 0:c.name} for ${null===e||void 0===e?void 0:e.name}.`);else a.materialType=s?{name:null===(p=s)||void 0===p?void 0:p.templateName}:null,t.success.push(`SUCCESS: ${i["Oracle Template"]} is updated for ${null===e||void 0===e?void 0:e.name} to ${null===C||void 0===C||null===(m=C.mcoPropeties)||void 0===m?void 0:m.plantName}`);else if(i["Oracle Template"]){var h;t.error.push(`ERROR: Part ${null===e||void 0===e?void 0:e.name} to plant ${null===C||void 0===C||null===(h=C.mcoPropeties)||void 0===h?void 0:h.plantName} is not valid due to Org Allowed, Part Type to Template, or EBOM disallowed or Missing.`)}}else{var x;t.error.push(`ERROR: ${i["Oracle Template"]} is invalid template for ${null===e||void 0===e?void 0:e.name} to ${null===C||void 0===C||null===(x=C.mcoPropeties)||void 0===x?void 0:x.plantName}`)}}else t.error.push("Invalid file. Please check the file.");if(null!==(n=Object.keys(s))&&void 0!==n&&n.length){let l=null===e||void 0===e?void 0:e.organization,t=(null===S||void 0===S?void 0:S.find((e=>{var t,i;return"buplantmapping"===e.MappingType&&(null===(t=e.BUID)||void 0===t?void 0:t.toLowerCase())===(null===l||void 0===l?void 0:l.toLowerCase())&&"bom or no bom"===(null===e||void 0===e||null===(i=e.details)||void 0===i?void 0:i.Entity.toLowerCase())})))||{},i=(null===S||void 0===S?void 0:S.filter((e=>{var t,i,o;return"orgallowedvalues"===e.MappingType&&(null===(t=e.BUID)||void 0===t?void 0:t.toLowerCase())===(null===l||void 0===l?void 0:l.toLowerCase())&&"y"===(null===e||void 0===e||null===(i=e.details)||void 0===i||null===(o=i.Has_MBOM)||void 0===o?void 0:o.toLowerCase())})).map((e=>{var l;return null===e||void 0===e||null===(l=e.details)||void 0===l?void 0:l.ALLOWABLE_ORG_TEMPLATES})))||[],o=!1,n=!1;var f;if(Object.keys(i).length)null!==i&&void 0!==i&&i.includes(null===(f=s)||void 0===f?void 0:f.templateName)&&(n=!0);if(Object.keys(t).length){var y,g;const e=null===t||void 0===t||null===(y=t.details)||void 0===y?void 0:y.PLANT,l=Object.keys(e).filter((l=>{var t;return"no bom"===(null===(t=e[l])||void 0===t?void 0:t.toLowerCase())}));null!==l&&void 0!==l&&l.includes(null===C||void 0===C||null===(g=C.mcoPropeties)||void 0===g?void 0:g.plantName)&&(o=!0)}n&&!o?(a.makeOrBuy="make",a.isMakeOrBuyValueChange=!0):(a.makeOrBuy="buy",a.isMakeOrBuyValueChange=!0)}return a}));return await x((0,O.qH)({mcoaffectedItem:n})),await x((0,O.$V)({affectedPartsData:n,bulkPartTemplates:e,isMaterialFormEdited:!0})),t}})]})]}),(0,A.jsxs)(v.Z,{open:W,onClose:async()=>{K(!1)},scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",maxWidth:"md",fullWidth:!0,className:"zIndex999",children:[(0,A.jsxs)(c.Z,{id:"scroll-dialog-title",children:["Tracker Details",(0,A.jsx)(s.Z,{variant:"contained",onClick:async()=>{await sl(!0,C)},disabled:!R||!(null!==(l=Object.keys(R))&&void 0!==l&&l.length)||"create"===(null===C||void 0===C||null===(t=C.mcoPropeties)||void 0===t||null===(o=t.mcostate)||void 0===o?void 0:o.toLowerCase()),className:"floatRight",children:"Refresh"})]}),(0,A.jsx)(p.Z,{dividers:!0,children:(0,A.jsx)(m.Z,{id:"scroll-dialog-description",tabIndex:-1,children:(0,A.jsx)(Ne.default,{fromPage:"mcodetails",mcoName:null===he||void 0===he?void 0:he.mco_id})})}),(0,A.jsx)(h.Z,{children:(0,A.jsx)(s.Z,{onClick:async()=>{K(!1)},children:"Close"})})]}),(0,A.jsx)(Me,{showHistoryBox:Y,setShowHistoryBox:X}),ne?(0,A.jsx)(ge.Z,{openAlert:te,openDesc:ne,setOpenAlert:oe}):(0,A.jsx)(A.Fragment,{}),U?(0,A.jsx)("div",{className:"textAlignCenter",children:(0,A.jsx)(w.Z,{show:U})}):(0,A.jsx)(A.Fragment,{})]})}},54343:(e,l,t)=>{t.r(l),t.d(l,{default:()=>k});var i=t(72791),o=t(95048),n=t(13461),a=t(44674),d=t(63875),s=t(74512),r=t(55261),u=t(11943),v=t(66934),c=t(16029),p=t(20890),m=t(35527),h=t(86711),x=(t(93270),t(57289)),f=t(80184);let y=[{type:"item",label:"Item details send to ERP",description:""},{type:"bos",label:"Bill of specification details send to ERP",description:""},{type:"bom",label:"ERP Change Order Creation",description:""},{type:"release",label:"Update Enovia MCO Lifecycle to Release",description:"MCO release is in progress. This process will take some time, so please refresh after a while."}];const g=(0,v.ZP)(n.Z)((e=>{let{theme:l,completed:t}=e;return{width:25,height:25,border:`2px solid ${t?l.palette.primary.main:l.palette.grey[500]}`,borderRadius:"50%"}})),b=(0,v.ZP)(a.Z,{shouldForwardProp:e=>"completed"!==e})((e=>{let{theme:l,completed:t}=e;return{"& .MuiStepConnector-line":{borderColor:l.palette.grey[500]},...t&&{"& .MuiStepConnector-line":{borderColor:l.palette.primary.main}}}}));function w(e){let{activeStepValue:l,currentMCOTrackerdetails:t={}}=e;const{responseData:n}=(0,o.v9)((e=>e.mcoDetails)),[a,v]=(0,i.useState)(-1),[w,j]=(0,i.useState)("inprogress"),[P,O]=(0,i.useState)(y),E=[0];return(0,i.useEffect)((()=>{if(Object.keys(l||{}).length){var e,i,o;const a=null===n||void 0===n||null===(e=n.mcoPropeties)||void 0===e||null===(i=e.mcostate)||void 0===i?void 0:i.toLowerCase(),d=null===y||void 0===y?void 0:y.map((e=>{var i,o,n,d,s;return null===l||void 0===l||null===(i=l.skippedstage)||void 0===i||!i.includes(null===e||void 0===e?void 0:e.type)||null!==e&&void 0!==e&&null!==(o=e.label)&&void 0!==o&&o.includes("Skipped")||(e.label=`${e.label} - Skipped not required`),null!==(n=["release"])&&void 0!==n&&n.includes(null===e||void 0===e?void 0:e.type)||(e.description=t[`${null===e||void 0===e?void 0:e.type}Message`]),null!==(d=["failed"])&&void 0!==d&&d.includes(t[`${null===e||void 0===e?void 0:e.type}Status`])?e.description=t[`${null===e||void 0===e?void 0:e.type}Message`]:null!==(s=["release"])&&void 0!==s&&s.includes(a)&&(e.description=""),e}));O(d),v(null===l||void 0===l?void 0:l.stepperValue),j(null===l||void 0===l||null===(o=l.currentStatus)||void 0===o?void 0:o.status)}}),[l]),(0,f.jsxs)(c.Z,{sx:{maxWidth:400},children:[(0,f.jsx)(d.Z,{activeStep:a,orientation:"vertical",className:"stepperContainer",children:P.map(((e,t)=>{var i;return(0,f.jsxs)(s.Z,{children:[(0,f.jsx)(r.Z,{className:`stepperSpace ${w} ${null!==l&&void 0!==l&&null!==(i=l.skippedstage)&&void 0!==i&&i.includes(null===e||void 0===e?void 0:e.type)?"skippedStep":""}`,StepIconComponent:e=>{var l;const{active:t}=e;return t&&null!==(l=["failed"])&&void 0!==l&&l.includes(w)?(0,f.jsx)(h.Z,{sx:{color:"red"}}):(0,f.jsx)(g,{...e})},children:e.label}),(0,f.jsx)(u.Z,{className:`stepperContentSpace ${w}`,children:(0,f.jsx)(p.Z,{children:(0,x.qS)(e.description)})}),(0,f.jsx)(b,{className:`${w}`,completed:null===E||void 0===E?void 0:E.includes(t)})]},e.label)}))}),a===P.length&&(0,f.jsx)(m.Z,{square:!0,elevation:0,sx:{p:3},style:{textAlign:"left"},children:(0,f.jsx)(p.Z,{children:"All steps were successfully completed!"})})]})}var j=t(93274),P=t(61889),O=t(20068),E=t(31220);t(31185);const C=(0,v.ZP)("div")((e=>{let{theme:l}=e;return{margin:"30px",[l.breakpoints.down("sm")]:{margin:"16px"},"& .breadcrumb":{marginBottom:"30px",[l.breakpoints.down("sm")]:{marginBottom:"16px"}}}})),T=e=>e&&e[0].toUpperCase()+e.slice(1);function S(e){const l={rme:"Responsible Manufacturing Engineer",rsme:"Responsible Senior Manufacturing Engineer",mcostate:"State",responseFromErp:"Export Status",plantName:"Plant"};return"description"===e.label?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(P.ZP,{item:!0,md:6,sm:6,xs:6,children:["Description",(0,f.jsx)("span",{style:{float:"right"},children:":"})]},`${e.label}-label`),(0,f.jsx)(P.ZP,{item:!0,md:6,sm:6,xs:6,children:(0,f.jsx)(O.Z,{title:(0,f.jsx)("div",{style:{maxHeight:"300px",overflowY:"scroll"},children:e.value}),arrow:!0,placement:"top",children:(0,f.jsx)("div",{style:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",maxWidth:"300px",cursor:"pointer"},children:e.value.length>50?`${e.value.substring(0,50)}...`:e.value})})},e.label)]}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(P.ZP,{item:!0,md:6,sm:6,xs:6,children:[Object.keys(l).includes(e.label)?T(l[e.label]):T(e.label),(0,f.jsx)("span",{style:{float:"right"},children:":"})]},e.label),(0,f.jsx)(P.ZP,{item:!0,md:6,sm:6,xs:6,children:""!==e.value?e.value:"-"})]})}const R=e=>{var l,t;let{isLoading:i,mcodetails:o,activeStep:n,currentMCOTrackerdetails:a}=e;return!!i||(o?(0,f.jsxs)(P.ZP,{container:!0,spacing:1,alignItems:"center",children:[(0,f.jsx)(P.ZP,{item:!0,md:6,sm:12,xs:12,children:(0,f.jsx)(P.ZP,{container:!0,spacing:1,alignItems:"center",children:(0,f.jsx)(P.ZP,{container:!0,spacing:2,alignItems:"start",className:"caDetailsContainer",children:o&&null!==(l=Object.keys(null===o||void 0===o?void 0:o.mcoPropeties))&&void 0!==l&&l.length?null===(t=Object.keys(null===o||void 0===o?void 0:o.mcoPropeties))||void 0===t?void 0:t.map((e=>!["id","type","physicalid","businessUnit","organizationId","responseFromErp","rmeEmailAddress","rsmeEmailAddress","errorMsg"].includes(e)&&(0,f.jsx)(S,{label:e,value:null===o||void 0===o?void 0:o.mcoPropeties[e]},e))):(0,f.jsx)(f.Fragment,{})},"samplekeys2")},"samplekeys")}),(0,f.jsx)(P.ZP,{item:!0,md:6,sm:12,xs:12,style:{textAlign:"right"},children:(0,f.jsx)(w,{activeStepValue:n,currentMCOTrackerdetails:a})})]}):(0,f.jsx)("div",{style:{textAlign:"center",paddingBottom:"10px"},children:"Result not found!"}))},k=e=>{const{lifeCycleData:l,responseData:t}=(0,o.v9)((e=>({lifeCycleData:e.mcoDetails.lifeCycleData,responseData:e.mcoDetails.responseData})),o.wU),[n,a]=(0,i.useState)(!1),[d,s]=(0,i.useState)(null),[r,u]=(0,i.useState)(null),[v,p]=(0,i.useState)({});return(0,i.useEffect)((()=>{const i=null===e||void 0===e?void 0:e.mcoName;((e,l)=>{var i,o,n,d;a(!0),s(t);const r=null===t||void 0===t||null===(i=t.mcoPropeties)||void 0===i||null===(o=i.mcostate)||void 0===o?void 0:o.toLowerCase();if(0===Object.keys(e).length)return void a(!1);const v=e[l]||{};let c=0,m={},h=[];if(null!==(n=Object.keys(v))&&void 0!==n&&n.length||!["release"].includes(r)){if(null!==(d=Object.keys(v))&&void 0!==d&&d.length){const e=!1;if("skipped"===v.promoted||e)c=4,m={type:"release",status:"success"},h=["item","bos","bom"];else{var x;for(const e of Object.keys(v)){if(Object.keys(m).length&&m.status.includes("failed"))continue;const l=v[e];"itemStatus"!==e||"skipped"!==l?"bosStatus"!==e||"skipped"!==l?"bomStatus"!==e||"skipped"!==l?["itemStatus","bosStatus","bomStatus","releaseStatus"].includes(e)&&["inprogress","success","failed"].includes(l)&&(["success"].includes(l)&&(c+=1),m={type:e.replace("Status",""),status:l}):(c+=1,h.push("bom")):(c+=1,h.push("bos")):(c+=1,h.push("item"))}null!==(x=Object.keys(v||{}))&&void 0!==x&&x.includes("releaseStatus")||3==c&&["release","implemented"].includes(r)&&(c+=1)}}}else c=4,m={type:"release",status:"success"},h=["item","bos","bom"];p({stepperValue:c,currentStatus:m,skippedstage:h}),u(v),a(!1)})(l,i)}),[l,t]),(0,f.jsxs)(C,{children:[null!==e&&void 0!==e&&e.fromPage?(0,f.jsx)(R,{isLoading:n,mcodetails:d,activeStep:v,currentMCOTrackerdetails:r}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(c.Z,{className:"breadcrumb",children:(0,f.jsx)(j.aG,{routeSegments:[{name:"MCO Status Tracker"}]})}),(0,f.jsx)(j.sF,{children:(0,f.jsx)(R,{isLoading:n,mcodetails:d,activeStep:v,currentMCOTrackerdetails:r})})]}),n?(0,f.jsx)("div",{style:{textAlign:"center"},children:(0,f.jsx)(E.Z,{show:n})}):(0,f.jsx)(f.Fragment,{})]})}},93270:()=>{}}]);
//# sourceMappingURL=710.dfff1044.chunk.js.map